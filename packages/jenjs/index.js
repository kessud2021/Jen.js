var Vn=Object.create;var sr=Object.defineProperty;var Zn=Object.getOwnPropertyDescriptor;var Qn=Object.getOwnPropertyNames;var Xn=Object.getPrototypeOf,ei=Object.prototype.hasOwnProperty;var V=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var ti=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var ri=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Qn(e))!ei.call(t,i)&&i!==r&&sr(t,i,{get:()=>e[i],enumerable:!(n=Zn(e,i))||n.enumerable});return t};var Ct=(t,e,r)=>(r=t!=null?Vn(Xn(t)):{},ri(e||!t||!t.__esModule?sr(r,"default",{value:t,enumerable:!0}):r,t));var xt=ti((zs,ln)=>{"use strict";var Kt=Object.defineProperty,Di=Object.getOwnPropertyDescriptor,Ti=Object.getOwnPropertyNames,Oi=Object.prototype.hasOwnProperty,Ii=(t,e)=>{for(var r in e)Kt(t,r,{get:e[r],enumerable:!0})},Pi=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ti(e))!Oi.call(t,i)&&i!==r&&Kt(t,i,{get:()=>e[i],enumerable:!(n=Di(e,i))||n.enumerable});return t},Mi=t=>Pi(Kt({},"__esModule",{value:!0}),t),Ge={};Ii(Ge,{analyzeMetafile:()=>po,analyzeMetafileSync:()=>ho,build:()=>so,buildSync:()=>uo,context:()=>ao,default:()=>wo,formatMessages:()=>co,formatMessagesSync:()=>mo,initialize:()=>yo,stop:()=>go,transform:()=>lo,transformSync:()=>fo,version:()=>oo});ln.exports=Mi(Ge);function Nr(t){let e=n=>{if(n===null)r.write8(0);else if(typeof n=="boolean")r.write8(1),r.write8(+n);else if(typeof n=="number")r.write8(2),r.write32(n|0);else if(typeof n=="string")r.write8(3),r.write(le(n));else if(n instanceof Uint8Array)r.write8(4),r.write(n);else if(n instanceof Array){r.write8(5),r.write32(n.length);for(let i of n)e(i)}else{let i=Object.keys(n);r.write8(6),r.write32(i.length);for(let o of i)r.write(le(o)),e(n[o])}},r=new Gr;return r.write32(0),r.write32(t.id<<1|+!t.isRequest),e(t.value),Jt(r.buf,r.len-4,0),r.buf.subarray(0,r.len)}function Ri(t){let e=()=>{switch(r.read8()){case 0:return null;case 1:return!!r.read8();case 2:return r.read32();case 3:return Re(r.read());case 4:return r.read();case 5:{let s=r.read32(),c=[];for(let a=0;a<s;a++)c.push(e());return c}case 6:{let s=r.read32(),c={};for(let a=0;a<s;a++)c[Re(r.read())]=e();return c}default:throw new Error("Invalid packet")}},r=new Gr(t),n=r.read32(),i=(n&1)===0;n>>>=1;let o=e();if(r.ptr!==t.length)throw new Error("Invalid packet");return{id:n,isRequest:i,value:o}}var Gr=class{constructor(t=new Uint8Array(1024)){this.buf=t,this.len=0,this.ptr=0}_write(t){if(this.len+t>this.buf.length){let e=new Uint8Array((this.len+t)*2);e.set(this.buf),this.buf=e}return this.len+=t,this.len-t}write8(t){let e=this._write(1);this.buf[e]=t}write32(t){let e=this._write(4);Jt(this.buf,t,e)}write(t){let e=this._write(4+t.length);Jt(this.buf,t.length,e),this.buf.set(t,e+4)}_read(t){if(this.ptr+t>this.buf.length)throw new Error("Invalid packet");return this.ptr+=t,this.ptr-t}read8(){return this.buf[this._read(1)]}read32(){return Yr(this.buf,this._read(4))}read(){let t=this.read32(),e=new Uint8Array(t),r=this._read(e.length);return e.set(this.buf.subarray(r,r+t)),e}},le,Re,Wt;if(typeof TextEncoder<"u"&&typeof TextDecoder<"u"){let t=new TextEncoder,e=new TextDecoder;le=r=>t.encode(r),Re=r=>e.decode(r),Wt='new TextEncoder().encode("")'}else if(typeof Buffer<"u")le=t=>Buffer.from(t),Re=t=>{let{buffer:e,byteOffset:r,byteLength:n}=t;return Buffer.from(e,r,n).toString()},Wt='Buffer.from("")';else throw new Error("No UTF-8 codec found");if(!(le("")instanceof Uint8Array))throw new Error(`Invariant violation: "${Wt} instanceof Uint8Array" is incorrectly false

This indicates that your JavaScript environment is broken. You cannot use
esbuild in this environment because esbuild relies on this invariant. This
is not a problem with esbuild. You need to fix your environment instead.
`);function Yr(t,e){return t[e++]|t[e++]<<8|t[e++]<<16|t[e++]<<24}function Jt(t,e,r){t[r++]=e,t[r++]=e>>8,t[r++]=e>>16,t[r++]=e>>24}var Y=JSON.stringify,Lr="warning",Fr="silent";function Me(t,e){let r=[];for(let n of t){if(ee(n,e),n.indexOf(",")>=0)throw new Error(`Invalid ${e}: ${n}`);r.push(n)}return r.join(",")}var ct=()=>null,z=t=>typeof t=="boolean"?null:"a boolean",D=t=>typeof t=="string"?null:"a string",pt=t=>t instanceof RegExp?null:"a RegExp object",Ee=t=>typeof t=="number"&&t===(t|0)?null:"an integer",Ni=t=>typeof t=="number"&&t===(t|0)&&t>=0&&t<=65535?null:"a valid port number",Kr=t=>typeof t=="function"?null:"a function",ge=t=>Array.isArray(t)?null:"an array",te=t=>Array.isArray(t)&&t.every(e=>typeof e=="string")?null:"an array of strings",re=t=>typeof t=="object"&&t!==null&&!Array.isArray(t)?null:"an object",Li=t=>typeof t=="object"&&t!==null?null:"an array or an object",Fi=t=>t instanceof WebAssembly.Module?null:"a WebAssembly.Module",Hr=t=>typeof t=="object"&&!Array.isArray(t)?null:"an object or null",Vr=t=>typeof t=="string"||typeof t=="boolean"?null:"a string or a boolean",Hi=t=>typeof t=="string"||typeof t=="object"&&t!==null&&!Array.isArray(t)?null:"a string or an object",Zr=t=>typeof t=="string"||Array.isArray(t)&&t.every(e=>typeof e=="string")?null:"a string or an array of strings",Qr=t=>typeof t=="string"||t instanceof Uint8Array?null:"a string or a Uint8Array",Ui=t=>typeof t=="string"||t instanceof URL?null:"a string or a URL";function f(t,e,r,n){let i=t[r];if(e[r+""]=!0,i===void 0)return;let o=n(i);if(o!==null)throw new Error(`${Y(r)} must be ${o}`);return i}function G(t,e,r){for(let n in t)if(!(n in e))throw new Error(`Invalid option ${r}: ${Y(n)}`)}function Bi(t){let e=Object.create(null),r=f(t,e,"wasmURL",Ui),n=f(t,e,"wasmModule",Fi),i=f(t,e,"worker",z);return G(t,e,"in initialize() call"),{wasmURL:r,wasmModule:n,worker:i}}function Xr(t){let e;if(t!==void 0){e=Object.create(null);for(let r in t){let n=t[r];if(typeof n=="string"||n===!1)e[r]=n;else throw new Error(`Expected ${Y(r)} in mangle cache to map to either a string or false`)}}return e}function ht(t,e,r,n,i){let o=f(e,r,"color",z),s=f(e,r,"logLevel",D),c=f(e,r,"logLimit",Ee);o!==void 0?t.push(`--color=${o}`):n&&t.push("--color=true"),t.push(`--log-level=${s||i}`),t.push(`--log-limit=${c||0}`)}function ee(t,e,r){if(typeof t!="string")throw new Error(`Expected value for ${e}${r!==void 0?" "+Y(r):""} to be a string, got ${typeof t} instead`);return t}function en(t,e,r){let n=f(e,r,"legalComments",D),i=f(e,r,"sourceRoot",D),o=f(e,r,"sourcesContent",z),s=f(e,r,"target",Zr),c=f(e,r,"format",D),a=f(e,r,"globalName",D),p=f(e,r,"mangleProps",pt),u=f(e,r,"reserveProps",pt),l=f(e,r,"mangleQuoted",z),E=f(e,r,"minify",z),m=f(e,r,"minifySyntax",z),g=f(e,r,"minifyWhitespace",z),$=f(e,r,"minifyIdentifiers",z),_=f(e,r,"lineLimit",Ee),y=f(e,r,"drop",te),x=f(e,r,"dropLabels",te),S=f(e,r,"charset",D),w=f(e,r,"treeShaking",z),b=f(e,r,"ignoreAnnotations",z),h=f(e,r,"jsx",D),C=f(e,r,"jsxFactory",D),P=f(e,r,"jsxFragment",D),N=f(e,r,"jsxImportSource",D),I=f(e,r,"jsxDev",z),d=f(e,r,"jsxSideEffects",z),v=f(e,r,"define",re),T=f(e,r,"logOverride",re),L=f(e,r,"supported",re),F=f(e,r,"pure",te),M=f(e,r,"keepNames",z),k=f(e,r,"platform",D),j=f(e,r,"tsconfigRaw",Hi),q=f(e,r,"absPaths",te);if(n&&t.push(`--legal-comments=${n}`),i!==void 0&&t.push(`--source-root=${i}`),o!==void 0&&t.push(`--sources-content=${o}`),s&&t.push(`--target=${Me(Array.isArray(s)?s:[s],"target")}`),c&&t.push(`--format=${c}`),a&&t.push(`--global-name=${a}`),k&&t.push(`--platform=${k}`),j&&t.push(`--tsconfig-raw=${typeof j=="string"?j:JSON.stringify(j)}`),E&&t.push("--minify"),m&&t.push("--minify-syntax"),g&&t.push("--minify-whitespace"),$&&t.push("--minify-identifiers"),_&&t.push(`--line-limit=${_}`),S&&t.push(`--charset=${S}`),w!==void 0&&t.push(`--tree-shaking=${w}`),b&&t.push("--ignore-annotations"),y)for(let A of y)t.push(`--drop:${ee(A,"drop")}`);if(x&&t.push(`--drop-labels=${Me(x,"drop label")}`),q&&t.push(`--abs-paths=${Me(q,"abs paths")}`),p&&t.push(`--mangle-props=${ut(p)}`),u&&t.push(`--reserve-props=${ut(u)}`),l!==void 0&&t.push(`--mangle-quoted=${l}`),h&&t.push(`--jsx=${h}`),C&&t.push(`--jsx-factory=${C}`),P&&t.push(`--jsx-fragment=${P}`),N&&t.push(`--jsx-import-source=${N}`),I&&t.push("--jsx-dev"),d&&t.push("--jsx-side-effects"),v)for(let A in v){if(A.indexOf("=")>=0)throw new Error(`Invalid define: ${A}`);t.push(`--define:${A}=${ee(v[A],"define",A)}`)}if(T)for(let A in T){if(A.indexOf("=")>=0)throw new Error(`Invalid log override: ${A}`);t.push(`--log-override:${A}=${ee(T[A],"log override",A)}`)}if(L)for(let A in L){if(A.indexOf("=")>=0)throw new Error(`Invalid supported: ${A}`);let R=L[A];if(typeof R!="boolean")throw new Error(`Expected value for supported ${Y(A)} to be a boolean, got ${typeof R} instead`);t.push(`--supported:${A}=${R}`)}if(F)for(let A of F)t.push(`--pure:${ee(A,"pure")}`);M&&t.push("--keep-names")}function qi(t,e,r,n,i){var o;let s=[],c=[],a=Object.create(null),p=null,u=null;ht(s,e,a,r,n),en(s,e,a);let l=f(e,a,"sourcemap",Vr),E=f(e,a,"bundle",z),m=f(e,a,"splitting",z),g=f(e,a,"preserveSymlinks",z),$=f(e,a,"metafile",z),_=f(e,a,"outfile",D),y=f(e,a,"outdir",D),x=f(e,a,"outbase",D),S=f(e,a,"tsconfig",D),w=f(e,a,"resolveExtensions",te),b=f(e,a,"nodePaths",te),h=f(e,a,"mainFields",te),C=f(e,a,"conditions",te),P=f(e,a,"external",te),N=f(e,a,"packages",D),I=f(e,a,"alias",re),d=f(e,a,"loader",re),v=f(e,a,"outExtension",re),T=f(e,a,"publicPath",D),L=f(e,a,"entryNames",D),F=f(e,a,"chunkNames",D),M=f(e,a,"assetNames",D),k=f(e,a,"inject",te),j=f(e,a,"banner",re),q=f(e,a,"footer",re),A=f(e,a,"entryPoints",Li),R=f(e,a,"absWorkingDir",D),U=f(e,a,"stdin",re),H=(o=f(e,a,"write",z))!=null?o:i,J=f(e,a,"allowOverwrite",z),W=f(e,a,"mangleCache",re);if(a.plugins=!0,G(e,a,`in ${t}() call`),l&&s.push(`--sourcemap${l===!0?"":`=${l}`}`),E&&s.push("--bundle"),J&&s.push("--allow-overwrite"),m&&s.push("--splitting"),g&&s.push("--preserve-symlinks"),$&&s.push("--metafile"),_&&s.push(`--outfile=${_}`),y&&s.push(`--outdir=${y}`),x&&s.push(`--outbase=${x}`),S&&s.push(`--tsconfig=${S}`),N&&s.push(`--packages=${N}`),w&&s.push(`--resolve-extensions=${Me(w,"resolve extension")}`),T&&s.push(`--public-path=${T}`),L&&s.push(`--entry-names=${L}`),F&&s.push(`--chunk-names=${F}`),M&&s.push(`--asset-names=${M}`),h&&s.push(`--main-fields=${Me(h,"main field")}`),C&&s.push(`--conditions=${Me(C,"condition")}`),P)for(let O of P)s.push(`--external:${ee(O,"external")}`);if(I)for(let O in I){if(O.indexOf("=")>=0)throw new Error(`Invalid package name in alias: ${O}`);s.push(`--alias:${O}=${ee(I[O],"alias",O)}`)}if(j)for(let O in j){if(O.indexOf("=")>=0)throw new Error(`Invalid banner file type: ${O}`);s.push(`--banner:${O}=${ee(j[O],"banner",O)}`)}if(q)for(let O in q){if(O.indexOf("=")>=0)throw new Error(`Invalid footer file type: ${O}`);s.push(`--footer:${O}=${ee(q[O],"footer",O)}`)}if(k)for(let O of k)s.push(`--inject:${ee(O,"inject")}`);if(d)for(let O in d){if(O.indexOf("=")>=0)throw new Error(`Invalid loader extension: ${O}`);s.push(`--loader:${O}=${ee(d[O],"loader",O)}`)}if(v)for(let O in v){if(O.indexOf("=")>=0)throw new Error(`Invalid out extension: ${O}`);s.push(`--out-extension:${O}=${ee(v[O],"out extension",O)}`)}if(A)if(Array.isArray(A))for(let O=0,fe=A.length;O<fe;O++){let ne=A[O];if(typeof ne=="object"&&ne!==null){let pe=Object.create(null),de=f(ne,pe,"in",D),ie=f(ne,pe,"out",D);if(G(ne,pe,"in entry point at index "+O),de===void 0)throw new Error('Missing property "in" for entry point at index '+O);if(ie===void 0)throw new Error('Missing property "out" for entry point at index '+O);c.push([ie,de])}else c.push(["",ee(ne,"entry point at index "+O)])}else for(let O in A)c.push([O,ee(A[O],"entry point",O)]);if(U){let O=Object.create(null),fe=f(U,O,"contents",Qr),ne=f(U,O,"resolveDir",D),pe=f(U,O,"sourcefile",D),de=f(U,O,"loader",D);G(U,O,'in "stdin" object'),pe&&s.push(`--sourcefile=${pe}`),de&&s.push(`--loader=${de}`),ne&&(u=ne),typeof fe=="string"?p=le(fe):fe instanceof Uint8Array&&(p=fe)}let se=[];if(b)for(let O of b)O+="",se.push(O);return{entries:c,flags:s,write:H,stdinContents:p,stdinResolveDir:u,absWorkingDir:R,nodePaths:se,mangleCache:Xr(W)}}function zi(t,e,r,n){let i=[],o=Object.create(null);ht(i,e,o,r,n),en(i,e,o);let s=f(e,o,"sourcemap",Vr),c=f(e,o,"sourcefile",D),a=f(e,o,"loader",D),p=f(e,o,"banner",D),u=f(e,o,"footer",D),l=f(e,o,"mangleCache",re);return G(e,o,`in ${t}() call`),s&&i.push(`--sourcemap=${s===!0?"external":s}`),c&&i.push(`--sourcefile=${c}`),a&&i.push(`--loader=${a}`),p&&i.push(`--banner=${p}`),u&&i.push(`--footer=${u}`),{flags:i,mangleCache:Xr(l)}}function tn(t){let e={},r={didClose:!1,reason:""},n={},i=0,o=0,s=new Uint8Array(16*1024),c=0,a=S=>{let w=c+S.length;if(w>s.length){let h=new Uint8Array(w*2);h.set(s),s=h}s.set(S,c),c+=S.length;let b=0;for(;b+4<=c;){let h=Yr(s,b);if(b+4+h>c)break;b+=4,g(s.subarray(b,b+h)),b+=h}b>0&&(s.copyWithin(0,b,c),c-=b)},p=S=>{r.didClose=!0,S&&(r.reason=": "+(S.message||S));let w="The service was stopped"+r.reason;for(let b in n)n[b](w,null);n={}},u=(S,w,b)=>{if(r.didClose)return b("The service is no longer running"+r.reason,null);let h=i++;n[h]=(C,P)=>{try{b(C,P)}finally{S&&S.unref()}},S&&S.ref(),t.writeToStdin(Nr({id:h,isRequest:!0,value:w}))},l=(S,w)=>{if(r.didClose)throw new Error("The service is no longer running"+r.reason);t.writeToStdin(Nr({id:S,isRequest:!1,value:w}))},E=async(S,w)=>{try{if(w.command==="ping"){l(S,{});return}if(typeof w.key=="number"){let b=e[w.key];if(!b)return;let h=b[w.command];if(h){await h(S,w);return}}throw new Error("Invalid command: "+w.command)}catch(b){let h=[Se(b,t,null,void 0,"")];try{l(S,{errors:h})}catch{}}},m=!0,g=S=>{if(m){m=!1;let b=String.fromCharCode(...S);if(b!=="0.25.12")throw new Error(`Cannot start service: Host version "0.25.12" does not match binary version ${Y(b)}`);return}let w=Ri(S);if(w.isRequest)E(w.id,w.value);else{let b=n[w.id];delete n[w.id],w.value.error?b(w.value.error,{}):b(null,w.value)}};return{readFromStdout:a,afterClose:p,service:{buildOrContext:({callName:S,refs:w,options:b,isTTY:h,defaultWD:C,callback:P})=>{let N=0,I=o++,d={},v={ref(){++N===1&&w&&w.ref()},unref(){--N===0&&(delete e[I],w&&w.unref())}};e[I]=d,v.ref(),Wi(S,I,u,l,v,t,d,b,h,C,(T,L)=>{try{P(T,L)}finally{v.unref()}})},transform:({callName:S,refs:w,input:b,options:h,isTTY:C,fs:P,callback:N})=>{let I=rn(),d=v=>{try{if(typeof b!="string"&&!(b instanceof Uint8Array))throw new Error('The input to "transform" must be a string or a Uint8Array');let{flags:T,mangleCache:L}=zi(S,h,C,Fr),F={command:"transform",flags:T,inputFS:v!==null,input:v!==null?le(v):typeof b=="string"?le(b):b};L&&(F.mangleCache=L),u(w,F,(M,k)=>{if(M)return N(new Error(M),null);let j=Ne(k.errors,I),q=Ne(k.warnings,I),A=1,R=()=>{if(--A===0){let U={warnings:q,code:k.code,map:k.map,mangleCache:void 0,legalComments:void 0};"legalComments"in k&&(U.legalComments=k?.legalComments),k.mangleCache&&(U.mangleCache=k?.mangleCache),N(null,U)}};if(j.length>0)return N(We("Transform failed",j,q),null);k.codeFS&&(A++,P.readFile(k.code,(U,H)=>{U!==null?N(U,null):(k.code=H,R())})),k.mapFS&&(A++,P.readFile(k.map,(U,H)=>{U!==null?N(U,null):(k.map=H,R())})),R()})}catch(T){let L=[];try{ht(L,h,{},C,Fr)}catch{}let F=Se(T,t,I,void 0,"");u(w,{command:"error",flags:L,error:F},()=>{F.detail=I.load(F.detail),N(We("Transform failed",[F],[]),null)})}};if((typeof b=="string"||b instanceof Uint8Array)&&b.length>1024*1024){let v=d;d=()=>P.writeFile(b,v)}d(null)},formatMessages:({callName:S,refs:w,messages:b,options:h,callback:C})=>{if(!h)throw new Error(`Missing second argument in ${S}() call`);let P={},N=f(h,P,"kind",D),I=f(h,P,"color",z),d=f(h,P,"terminalWidth",Ee);if(G(h,P,`in ${S}() call`),N===void 0)throw new Error(`Missing "kind" in ${S}() call`);if(N!=="error"&&N!=="warning")throw new Error(`Expected "kind" to be "error" or "warning" in ${S}() call`);let v={command:"format-msgs",messages:ye(b,"messages",null,"",d),isWarning:N==="warning"};I!==void 0&&(v.color=I),d!==void 0&&(v.terminalWidth=d),u(w,v,(T,L)=>{if(T)return C(new Error(T),null);C(null,L.messages)})},analyzeMetafile:({callName:S,refs:w,metafile:b,options:h,callback:C})=>{h===void 0&&(h={});let P={},N=f(h,P,"color",z),I=f(h,P,"verbose",z);G(h,P,`in ${S}() call`);let d={command:"analyze-metafile",metafile:b};N!==void 0&&(d.color=N),I!==void 0&&(d.verbose=I),u(w,d,(v,T)=>{if(v)return C(new Error(v),null);C(null,T.result)})}}}}function Wi(t,e,r,n,i,o,s,c,a,p,u){let l=rn(),E=t==="context",m=(_,y)=>{let x=[];try{ht(x,c,{},a,Lr)}catch{}let S=Se(_,o,l,void 0,y);r(i,{command:"error",flags:x,error:S},()=>{S.detail=l.load(S.detail),u(We(E?"Context failed":"Build failed",[S],[]),null)})},g;if(typeof c=="object"){let _=c.plugins;if(_!==void 0){if(!Array.isArray(_))return m(new Error('"plugins" must be an array'),"");g=_}}if(g&&g.length>0){if(o.isSync)return m(new Error("Cannot use plugins in synchronous API calls"),"");Ji(e,r,n,i,o,s,c,g,l).then(_=>{if(!_.ok)return m(_.error,_.pluginName);try{$(_.requestPlugins,_.runOnEndCallbacks,_.scheduleOnDisposeCallbacks)}catch(y){m(y,"")}},_=>m(_,""));return}try{$(null,(_,y)=>y([],[]),()=>{})}catch(_){m(_,"")}function $(_,y,x){let S=o.hasFS,{entries:w,flags:b,write:h,stdinContents:C,stdinResolveDir:P,absWorkingDir:N,nodePaths:I,mangleCache:d}=qi(t,c,a,Lr,S);if(h&&!o.hasFS)throw new Error('The "write" option is unavailable in this environment');let v={command:"build",key:e,entries:w,flags:b,write:h,stdinContents:C,stdinResolveDir:P,absWorkingDir:N||p,nodePaths:I,context:E};_&&(v.plugins=_),d&&(v.mangleCache=d);let T=(M,k)=>{let j={errors:Ne(M.errors,l),warnings:Ne(M.warnings,l),outputFiles:void 0,metafile:void 0,mangleCache:void 0},q=j.errors.slice(),A=j.warnings.slice();M.outputFiles&&(j.outputFiles=M.outputFiles.map(Yi)),M.metafile&&(j.metafile=JSON.parse(M.metafile)),M.mangleCache&&(j.mangleCache=M.mangleCache),M.writeToStdout!==void 0&&console.log(Re(M.writeToStdout).replace(/\n$/,"")),y(j,(R,U)=>{if(q.length>0||R.length>0){let H=We("Build failed",q.concat(R),A.concat(U));return k(H,null,R,U)}k(null,j,R,U)})},L,F;E&&(s["on-end"]=(M,k)=>new Promise(j=>{T(k,(q,A,R,U)=>{let H={errors:R,warnings:U};F&&F(q,A),L=void 0,F=void 0,n(M,H),j()})})),r(i,v,(M,k)=>{if(M)return u(new Error(M),null);if(!E)return T(k,(A,R)=>(x(),u(A,R)));if(k.errors.length>0)return u(We("Context failed",k.errors,k.warnings),null);let j=!1,q={rebuild:()=>(L||(L=new Promise((A,R)=>{let U;F=(J,W)=>{U||(U=()=>J?R(J):A(W))};let H=()=>{r(i,{command:"rebuild",key:e},(W,se)=>{W?R(new Error(W)):U?U():H()})};H()})),L),watch:(A={})=>new Promise((R,U)=>{if(!o.hasFS)throw new Error('Cannot use the "watch" API in this environment');let H={},J=f(A,H,"delay",Ee);G(A,H,"in watch() call");let W={command:"watch",key:e};J&&(W.delay=J),r(i,W,se=>{se?U(new Error(se)):R(void 0)})}),serve:(A={})=>new Promise((R,U)=>{if(!o.hasFS)throw new Error('Cannot use the "serve" API in this environment');let H={},J=f(A,H,"port",Ni),W=f(A,H,"host",D),se=f(A,H,"servedir",D),O=f(A,H,"keyfile",D),fe=f(A,H,"certfile",D),ne=f(A,H,"fallback",D),pe=f(A,H,"cors",re),de=f(A,H,"onRequest",Kr);G(A,H,"in serve() call");let ie={command:"serve",key:e,onRequest:!!de};if(J!==void 0&&(ie.port=J),W!==void 0&&(ie.host=W),se!==void 0&&(ie.servedir=se),O!==void 0&&(ie.keyfile=O),fe!==void 0&&(ie.certfile=fe),ne!==void 0&&(ie.fallback=ne),pe){let He={},Ce=f(pe,He,"origin",Zr);G(pe,He,'on "cors" object'),Array.isArray(Ce)?ie.corsOrigin=Ce:Ce!==void 0&&(ie.corsOrigin=[Ce])}r(i,ie,(He,Ce)=>{if(He)return U(new Error(He));de&&(s["serve-request"]=(Yn,Kn)=>{de(Kn.args),n(Yn,{})}),R(Ce)})}),cancel:()=>new Promise(A=>{if(j)return A();r(i,{command:"cancel",key:e},()=>{A()})}),dispose:()=>new Promise(A=>{if(j)return A();j=!0,r(i,{command:"dispose",key:e},()=>{A(),x(),i.unref()})})};i.ref(),u(null,q)})}}var Ji=async(t,e,r,n,i,o,s,c,a)=>{let p=[],u=[],l={},E={},m=[],g=0,$=0,_=[],y=!1;c=[...c];for(let w of c){let b={};if(typeof w!="object")throw new Error(`Plugin at index ${$} must be an object`);let h=f(w,b,"name",D);if(typeof h!="string"||h==="")throw new Error(`Plugin at index ${$} is missing a name`);try{let C=f(w,b,"setup",Kr);if(typeof C!="function")throw new Error("Plugin is missing a setup function");G(w,b,`on plugin ${Y(h)}`);let P={name:h,onStart:!1,onEnd:!1,onResolve:[],onLoad:[]};$++;let I=C({initialOptions:s,resolve:(d,v={})=>{if(!y)throw new Error('Cannot call "resolve" before plugin setup has completed');if(typeof d!="string")throw new Error("The path to resolve must be a string");let T=Object.create(null),L=f(v,T,"pluginName",D),F=f(v,T,"importer",D),M=f(v,T,"namespace",D),k=f(v,T,"resolveDir",D),j=f(v,T,"kind",D),q=f(v,T,"pluginData",ct),A=f(v,T,"with",re);return G(v,T,"in resolve() call"),new Promise((R,U)=>{let H={command:"resolve",path:d,key:t,pluginName:h};if(L!=null&&(H.pluginName=L),F!=null&&(H.importer=F),M!=null&&(H.namespace=M),k!=null&&(H.resolveDir=k),j!=null)H.kind=j;else throw new Error('Must specify "kind" when calling "resolve"');q!=null&&(H.pluginData=a.store(q)),A!=null&&(H.with=Gi(A,"with")),e(n,H,(J,W)=>{J!==null?U(new Error(J)):R({errors:Ne(W.errors,a),warnings:Ne(W.warnings,a),path:W.path,external:W.external,sideEffects:W.sideEffects,namespace:W.namespace,suffix:W.suffix,pluginData:a.load(W.pluginData)})})})},onStart(d){let v='This error came from the "onStart" callback registered here:',T=at(new Error(v),i,"onStart");p.push({name:h,callback:d,note:T}),P.onStart=!0},onEnd(d){let v='This error came from the "onEnd" callback registered here:',T=at(new Error(v),i,"onEnd");u.push({name:h,callback:d,note:T}),P.onEnd=!0},onResolve(d,v){let T='This error came from the "onResolve" callback registered here:',L=at(new Error(T),i,"onResolve"),F={},M=f(d,F,"filter",pt),k=f(d,F,"namespace",D);if(G(d,F,`in onResolve() call for plugin ${Y(h)}`),M==null)throw new Error("onResolve() call is missing a filter");let j=g++;l[j]={name:h,callback:v,note:L},P.onResolve.push({id:j,filter:ut(M),namespace:k||""})},onLoad(d,v){let T='This error came from the "onLoad" callback registered here:',L=at(new Error(T),i,"onLoad"),F={},M=f(d,F,"filter",pt),k=f(d,F,"namespace",D);if(G(d,F,`in onLoad() call for plugin ${Y(h)}`),M==null)throw new Error("onLoad() call is missing a filter");let j=g++;E[j]={name:h,callback:v,note:L},P.onLoad.push({id:j,filter:ut(M),namespace:k||""})},onDispose(d){m.push(d)},esbuild:i.esbuild});I&&await I,_.push(P)}catch(C){return{ok:!1,error:C,pluginName:h}}}o["on-start"]=async(w,b)=>{a.clear();let h={errors:[],warnings:[]};await Promise.all(p.map(async({name:C,callback:P,note:N})=>{try{let I=await P();if(I!=null){if(typeof I!="object")throw new Error(`Expected onStart() callback in plugin ${Y(C)} to return an object`);let d={},v=f(I,d,"errors",ge),T=f(I,d,"warnings",ge);G(I,d,`from onStart() callback in plugin ${Y(C)}`),v!=null&&h.errors.push(...ye(v,"errors",a,C,void 0)),T!=null&&h.warnings.push(...ye(T,"warnings",a,C,void 0))}}catch(I){h.errors.push(Se(I,i,a,N&&N(),C))}})),r(w,h)},o["on-resolve"]=async(w,b)=>{let h={},C="",P,N;for(let I of b.ids)try{({name:C,callback:P,note:N}=l[I]);let d=await P({path:b.path,importer:b.importer,namespace:b.namespace,resolveDir:b.resolveDir,kind:b.kind,pluginData:a.load(b.pluginData),with:b.with});if(d!=null){if(typeof d!="object")throw new Error(`Expected onResolve() callback in plugin ${Y(C)} to return an object`);let v={},T=f(d,v,"pluginName",D),L=f(d,v,"path",D),F=f(d,v,"namespace",D),M=f(d,v,"suffix",D),k=f(d,v,"external",z),j=f(d,v,"sideEffects",z),q=f(d,v,"pluginData",ct),A=f(d,v,"errors",ge),R=f(d,v,"warnings",ge),U=f(d,v,"watchFiles",te),H=f(d,v,"watchDirs",te);G(d,v,`from onResolve() callback in plugin ${Y(C)}`),h.id=I,T!=null&&(h.pluginName=T),L!=null&&(h.path=L),F!=null&&(h.namespace=F),M!=null&&(h.suffix=M),k!=null&&(h.external=k),j!=null&&(h.sideEffects=j),q!=null&&(h.pluginData=a.store(q)),A!=null&&(h.errors=ye(A,"errors",a,C,void 0)),R!=null&&(h.warnings=ye(R,"warnings",a,C,void 0)),U!=null&&(h.watchFiles=lt(U,"watchFiles")),H!=null&&(h.watchDirs=lt(H,"watchDirs"));break}}catch(d){h={id:I,errors:[Se(d,i,a,N&&N(),C)]};break}r(w,h)},o["on-load"]=async(w,b)=>{let h={},C="",P,N;for(let I of b.ids)try{({name:C,callback:P,note:N}=E[I]);let d=await P({path:b.path,namespace:b.namespace,suffix:b.suffix,pluginData:a.load(b.pluginData),with:b.with});if(d!=null){if(typeof d!="object")throw new Error(`Expected onLoad() callback in plugin ${Y(C)} to return an object`);let v={},T=f(d,v,"pluginName",D),L=f(d,v,"contents",Qr),F=f(d,v,"resolveDir",D),M=f(d,v,"pluginData",ct),k=f(d,v,"loader",D),j=f(d,v,"errors",ge),q=f(d,v,"warnings",ge),A=f(d,v,"watchFiles",te),R=f(d,v,"watchDirs",te);G(d,v,`from onLoad() callback in plugin ${Y(C)}`),h.id=I,T!=null&&(h.pluginName=T),L instanceof Uint8Array?h.contents=L:L!=null&&(h.contents=le(L)),F!=null&&(h.resolveDir=F),M!=null&&(h.pluginData=a.store(M)),k!=null&&(h.loader=k),j!=null&&(h.errors=ye(j,"errors",a,C,void 0)),q!=null&&(h.warnings=ye(q,"warnings",a,C,void 0)),A!=null&&(h.watchFiles=lt(A,"watchFiles")),R!=null&&(h.watchDirs=lt(R,"watchDirs"));break}}catch(d){h={id:I,errors:[Se(d,i,a,N&&N(),C)]};break}r(w,h)};let x=(w,b)=>b([],[]);u.length>0&&(x=(w,b)=>{(async()=>{let h=[],C=[];for(let{name:P,callback:N,note:I}of u){let d,v;try{let T=await N(w);if(T!=null){if(typeof T!="object")throw new Error(`Expected onEnd() callback in plugin ${Y(P)} to return an object`);let L={},F=f(T,L,"errors",ge),M=f(T,L,"warnings",ge);G(T,L,`from onEnd() callback in plugin ${Y(P)}`),F!=null&&(d=ye(F,"errors",a,P,void 0)),M!=null&&(v=ye(M,"warnings",a,P,void 0))}}catch(T){d=[Se(T,i,a,I&&I(),P)]}if(d){h.push(...d);try{w.errors.push(...d)}catch{}}if(v){C.push(...v);try{w.warnings.push(...v)}catch{}}}b(h,C)})()});let S=()=>{for(let w of m)setTimeout(()=>w(),0)};return y=!0,{ok:!0,requestPlugins:_,runOnEndCallbacks:x,scheduleOnDisposeCallbacks:S}};function rn(){let t=new Map,e=0;return{clear(){t.clear()},load(r){return t.get(r)},store(r){if(r===void 0)return-1;let n=e++;return t.set(n,r),n}}}function at(t,e,r){let n,i=!1;return()=>{if(i)return n;i=!0;try{let o=(t.stack+"").split(`
`);o.splice(1,1);let s=nn(e,o,r);if(s)return n={text:t.message,location:s},n}catch{}}}function Se(t,e,r,n,i){let o="Internal error",s=null;try{o=(t&&t.message||t)+""}catch{}try{s=nn(e,(t.stack+"").split(`
`),"")}catch{}return{id:"",pluginName:i,text:o,location:s,notes:n?[n]:[],detail:r?r.store(t):-1}}function nn(t,e,r){let n="    at ";if(t.readFileSync&&!e[0].startsWith(n)&&e[1].startsWith(n))for(let i=1;i<e.length;i++){let o=e[i];if(o.startsWith(n))for(o=o.slice(n.length);;){let s=/^(?:new |async )?\S+ \((.*)\)$/.exec(o);if(s){o=s[1];continue}if(s=/^eval at \S+ \((.*)\)(?:, \S+:\d+:\d+)?$/.exec(o),s){o=s[1];continue}if(s=/^(\S+):(\d+):(\d+)$/.exec(o),s){let c;try{c=t.readFileSync(s[1],"utf8")}catch{break}let a=c.split(/\r\n|\r|\n|\u2028|\u2029/)[+s[2]-1]||"",p=+s[3]-1,u=a.slice(p,p+r.length)===r?r.length:0;return{file:s[1],namespace:"file",line:+s[2],column:le(a.slice(0,p)).length,length:le(a.slice(p,p+u)).length,lineText:a+`
`+e.slice(1).join(`
`),suggestion:""}}break}}return null}function We(t,e,r){let n=5;t+=e.length<1?"":` with ${e.length} error${e.length<2?"":"s"}:`+e.slice(0,n+1).map((o,s)=>{if(s===n)return`
...`;if(!o.location)return`
error: ${o.text}`;let{file:c,line:a,column:p}=o.location,u=o.pluginName?`[plugin: ${o.pluginName}] `:"";return`
${c}:${a}:${p}: ERROR: ${u}${o.text}`}).join("");let i=new Error(t);for(let[o,s]of[["errors",e],["warnings",r]])Object.defineProperty(i,o,{configurable:!0,enumerable:!0,get:()=>s,set:c=>Object.defineProperty(i,o,{configurable:!0,enumerable:!0,value:c})});return i}function Ne(t,e){for(let r of t)r.detail=e.load(r.detail);return t}function Ur(t,e,r){if(t==null)return null;let n={},i=f(t,n,"file",D),o=f(t,n,"namespace",D),s=f(t,n,"line",Ee),c=f(t,n,"column",Ee),a=f(t,n,"length",Ee),p=f(t,n,"lineText",D),u=f(t,n,"suggestion",D);if(G(t,n,e),p){let l=p.slice(0,(c&&c>0?c:0)+(a&&a>0?a:0)+(r&&r>0?r:80));!/[\x7F-\uFFFF]/.test(l)&&!/\n/.test(p)&&(p=l)}return{file:i||"",namespace:o||"",line:s||0,column:c||0,length:a||0,lineText:p||"",suggestion:u||""}}function ye(t,e,r,n,i){let o=[],s=0;for(let c of t){let a={},p=f(c,a,"id",D),u=f(c,a,"pluginName",D),l=f(c,a,"text",D),E=f(c,a,"location",Hr),m=f(c,a,"notes",ge),g=f(c,a,"detail",ct),$=`in element ${s} of "${e}"`;G(c,a,$);let _=[];if(m)for(let y of m){let x={},S=f(y,x,"text",D),w=f(y,x,"location",Hr);G(y,x,$),_.push({text:S||"",location:Ur(w,$,i)})}o.push({id:p||"",pluginName:u||n,text:l||"",location:Ur(E,$,i),notes:_,detail:r?r.store(g):-1}),s++}return o}function lt(t,e){let r=[];for(let n of t){if(typeof n!="string")throw new Error(`${Y(e)} must be an array of strings`);r.push(n)}return r}function Gi(t,e){let r=Object.create(null);for(let n in t){let i=t[n];if(typeof i!="string")throw new Error(`key ${Y(n)} in object ${Y(e)} must be a string`);r[n]=i}return r}function Yi({path:t,contents:e,hash:r}){let n=null;return{path:t,contents:e,hash:r,get text(){let i=this.contents;return(n===null||i!==e)&&(e=i,n=Re(i)),n}}}function ut(t){let e=t.source;return t.flags&&(e=`(?${t.flags})${e}`),e}var be=V("fs"),Br=V("os"),oe=V("path"),Pe=process.env.ESBUILD_BINARY_PATH||Pe,Ki=t=>!!t&&t!=="/usr/bin/esbuild",qr="@esbuild/darwin-arm64",zr="@esbuild/darwin-x64",ft={"win32 arm64 LE":"@esbuild/win32-arm64","win32 ia32 LE":"@esbuild/win32-ia32","win32 x64 LE":"@esbuild/win32-x64"},dt={"aix ppc64 BE":"@esbuild/aix-ppc64","android arm64 LE":"@esbuild/android-arm64","darwin arm64 LE":"@esbuild/darwin-arm64","darwin x64 LE":"@esbuild/darwin-x64","freebsd arm64 LE":"@esbuild/freebsd-arm64","freebsd x64 LE":"@esbuild/freebsd-x64","linux arm LE":"@esbuild/linux-arm","linux arm64 LE":"@esbuild/linux-arm64","linux ia32 LE":"@esbuild/linux-ia32","linux mips64el LE":"@esbuild/linux-mips64el","linux ppc64 LE":"@esbuild/linux-ppc64","linux riscv64 LE":"@esbuild/linux-riscv64","linux s390x BE":"@esbuild/linux-s390x","linux x64 LE":"@esbuild/linux-x64","linux loong64 LE":"@esbuild/linux-loong64","netbsd arm64 LE":"@esbuild/netbsd-arm64","netbsd x64 LE":"@esbuild/netbsd-x64","openbsd arm64 LE":"@esbuild/openbsd-arm64","openbsd x64 LE":"@esbuild/openbsd-x64","sunos x64 LE":"@esbuild/sunos-x64"},Wr={"android arm LE":"@esbuild/android-arm","android x64 LE":"@esbuild/android-x64","openharmony arm64 LE":"@esbuild/openharmony-arm64"};function Vi(){let t,e,r=!1,n=`${process.platform} ${Br.arch()} ${Br.endianness()}`;if(n in ft)t=ft[n],e="esbuild.exe";else if(n in dt)t=dt[n],e="bin/esbuild";else if(n in Wr)t=Wr[n],e="bin/esbuild",r=!0;else throw new Error(`Unsupported platform: ${n}`);return{pkg:t,subpath:e,isWASM:r}}function Zi(){let t=V.resolve("esbuild"),e=oe.dirname(oe.dirname(oe.dirname(t)));if(oe.basename(e)==="node_modules"){for(let r in dt)try{let n=dt[r];if(be.existsSync(oe.join(e,n)))return n}catch{}for(let r in ft)try{let n=ft[r];if(be.existsSync(oe.join(e,n)))return n}catch{}}return null}function Qi(t,e){let r=oe.dirname(V.resolve("esbuild"));return oe.join(r,`downloaded-${t.replace("/","-")}-${oe.basename(e)}`)}function Xi(){if(Ki(Pe))if(!be.existsSync(Pe))console.warn(`[esbuild] Ignoring bad configuration: ESBUILD_BINARY_PATH=${Pe}`);else return{binPath:Pe,isWASM:!1};let{pkg:t,subpath:e,isWASM:r}=Vi(),n;try{n=V.resolve(`${t}/${e}`)}catch(i){if(n=Qi(t,e),!be.existsSync(n)){try{V.resolve(t)}catch{let o=Zi();if(o){let s=`
Specifically the "${o}" package is present but this platform
needs the "${t}" package instead. People often get into this
situation by installing esbuild on Windows or macOS and copying "node_modules"
into a Docker image that runs Linux, or by copying "node_modules" between
Windows and WSL environments.

If you are installing with npm, you can try not copying the "node_modules"
directory when you copy the files over, and running "npm ci" or "npm install"
on the destination platform after the copy. Or you could consider using yarn
instead of npm which has built-in support for installing a package on multiple
platforms simultaneously.

If you are installing with yarn, you can try listing both this platform and the
other platform in your ".yarnrc.yml" file using the "supportedArchitectures"
feature: https://yarnpkg.com/configuration/yarnrc/#supportedArchitectures
Keep in mind that this means multiple copies of esbuild will be present.
`;throw(t===zr&&o===qr||t===qr&&o===zr)&&(s=`
Specifically the "${o}" package is present but this platform
needs the "${t}" package instead. People often get into this
situation by installing esbuild with npm running inside of Rosetta 2 and then
trying to use it with node running outside of Rosetta 2, or vice versa (Rosetta
2 is Apple's on-the-fly x86_64-to-arm64 translation service).

If you are installing with npm, you can try ensuring that both npm and node are
not running under Rosetta 2 and then reinstalling esbuild. This likely involves
changing how you installed npm and/or node. For example, installing node with
the universal installer here should work: https://nodejs.org/en/download/. Or
you could consider using yarn instead of npm which has built-in support for
installing a package on multiple platforms simultaneously.

If you are installing with yarn, you can try listing both "arm64" and "x64"
in your ".yarnrc.yml" file using the "supportedArchitectures" feature:
https://yarnpkg.com/configuration/yarnrc/#supportedArchitectures
Keep in mind that this means multiple copies of esbuild will be present.
`),new Error(`
You installed esbuild for another platform than the one you're currently using.
This won't work because esbuild is written with native code and needs to
install a platform-specific binary executable.
${s}
Another alternative is to use the "esbuild-wasm" package instead, which works
the same way on all platforms. But it comes with a heavy performance cost and
can sometimes be 10x slower than the "esbuild" package, so you may also not
want to do that.
`)}throw new Error(`The package "${t}" could not be found, and is needed by esbuild.

If you are installing esbuild with npm, make sure that you don't specify the
"--no-optional" or "--omit=optional" flags. The "optionalDependencies" feature
of "package.json" is used by esbuild to install the correct binary executable
for your current platform.`)}throw i}}if(/\.zip\//.test(n)){let i;try{i=V("pnpapi")}catch{}if(i){let o=i.getPackageInformation(i.topLevel).packageLocation,s=oe.join(o,"node_modules",".cache","esbuild",`pnpapi-${t.replace("/","-")}-0.25.12-${oe.basename(e)}`);return be.existsSync(s)||(be.mkdirSync(oe.dirname(s),{recursive:!0}),be.copyFileSync(n,s),be.chmodSync(s,493)),{binPath:s,isWASM:r}}}return{binPath:n,isWASM:r}}var on=V("child_process"),eo=V("crypto"),Gt=V("path"),$e=V("fs"),to=V("os"),ro=V("tty"),Q;if(process.env.ESBUILD_WORKER_THREADS!=="0"){try{Q=V("worker_threads")}catch{}let[t,e]=process.versions.node.split(".");(+t<12||+t==12&&+e<17||+t==13&&+e<13)&&(Q=void 0)}var Jr,Ye=((Jr=Q?.workerData)==null?void 0:Jr.esbuildVersion)==="0.25.12",sn=()=>{if(!Pe&&(Gt.basename(__filename)!=="main.js"||Gt.basename(__dirname)!=="lib"))throw new Error(`The esbuild JavaScript API cannot be bundled. Please mark the "esbuild" package as external so it's not included in the bundle.

More information: The file containing the code for esbuild's JavaScript API (${__filename}) does not appear to be inside the esbuild package on the file system, which usually means that the esbuild package was bundled into another file. This is problematic because the API needs to run a binary executable inside the esbuild package which is located using a relative path from the API code to the executable. If the esbuild package is bundled, the relative path will be incorrect and the executable won't be found.`);{let{binPath:t,isWASM:e}=Xi();return e?["node",[t]]:[t,[]]}},Je=()=>ro.isatty(2),no={readFile(t,e){try{let r=$e.readFileSync(t,"utf8");try{$e.unlinkSync(t)}catch{}e(null,r)}catch(r){e(r,null)}},writeFile(t,e){try{let r=an();$e.writeFileSync(r,t),e(r)}catch{e(null)}}},io={readFile(t,e){try{$e.readFile(t,"utf8",(r,n)=>{try{$e.unlink(t,()=>e(r,n))}catch{e(r,n)}})}catch(r){e(r,null)}},writeFile(t,e){try{let r=an();$e.writeFile(r,t,n=>e(n!==null?null:r))}catch{e(null)}}},oo="0.25.12",so=t=>Ae().build(t),ao=t=>Ae().context(t),lo=(t,e)=>Ae().transform(t,e),co=(t,e)=>Ae().formatMessages(t,e),po=(t,e)=>Ae().analyzeMetafile(t,e),uo=t=>{if(Q&&!Ye)return X||(X=yt(Q)),X.buildSync(t);let e;return gt(r=>r.buildOrContext({callName:"buildSync",refs:null,options:t,isTTY:Je(),defaultWD:ke,callback:(n,i)=>{if(n)throw n;e=i}})),e},fo=(t,e)=>{if(Q&&!Ye)return X||(X=yt(Q)),X.transformSync(t,e);let r;return gt(n=>n.transform({callName:"transformSync",refs:null,input:t,options:e||{},isTTY:Je(),fs:no,callback:(i,o)=>{if(i)throw i;r=o}})),r},mo=(t,e)=>{if(Q&&!Ye)return X||(X=yt(Q)),X.formatMessagesSync(t,e);let r;return gt(n=>n.formatMessages({callName:"formatMessagesSync",refs:null,messages:t,options:e,callback:(i,o)=>{if(i)throw i;r=o}})),r},ho=(t,e)=>{if(Q&&!Ye)return X||(X=yt(Q)),X.analyzeMetafileSync(t,e);let r;return gt(n=>n.analyzeMetafile({callName:"analyzeMetafileSync",refs:null,metafile:typeof t=="string"?t:JSON.stringify(t),options:e,callback:(i,o)=>{if(i)throw i;r=o}})),r},go=()=>(mt&&mt(),X&&X.stop(),Promise.resolve()),Yt=!1,yo=t=>{if(t=Bi(t||{}),t.wasmURL)throw new Error('The "wasmURL" option only works in the browser');if(t.wasmModule)throw new Error('The "wasmModule" option only works in the browser');if(t.worker)throw new Error('The "worker" option only works in the browser');if(Yt)throw new Error('Cannot call "initialize" more than once');return Ae(),Yt=!0,Promise.resolve()},ke=process.cwd(),ze,mt,Ae=()=>{if(ze)return ze;let[t,e]=sn(),r=on.spawn(t,e.concat("--service=0.25.12","--ping"),{windowsHide:!0,stdio:["pipe","pipe","inherit"],cwd:ke}),{readFromStdout:n,afterClose:i,service:o}=tn({writeToStdin(u){r.stdin.write(u,l=>{l&&i(l)})},readFileSync:$e.readFileSync,isSync:!1,hasFS:!0,esbuild:Ge});r.stdin.on("error",i),r.on("error",i);let s=r.stdin,c=r.stdout;c.on("data",n),c.on("end",i),mt=()=>{s.destroy(),c.destroy(),r.kill(),Yt=!1,ze=void 0,mt=void 0};let a=0;r.unref(),s.unref&&s.unref(),c.unref&&c.unref();let p={ref(){++a===1&&r.ref()},unref(){--a===0&&r.unref()}};return ze={build:u=>new Promise((l,E)=>{o.buildOrContext({callName:"build",refs:p,options:u,isTTY:Je(),defaultWD:ke,callback:(m,g)=>m?E(m):l(g)})}),context:u=>new Promise((l,E)=>o.buildOrContext({callName:"context",refs:p,options:u,isTTY:Je(),defaultWD:ke,callback:(m,g)=>m?E(m):l(g)})),transform:(u,l)=>new Promise((E,m)=>o.transform({callName:"transform",refs:p,input:u,options:l||{},isTTY:Je(),fs:io,callback:(g,$)=>g?m(g):E($)})),formatMessages:(u,l)=>new Promise((E,m)=>o.formatMessages({callName:"formatMessages",refs:p,messages:u,options:l,callback:(g,$)=>g?m(g):E($)})),analyzeMetafile:(u,l)=>new Promise((E,m)=>o.analyzeMetafile({callName:"analyzeMetafile",refs:p,metafile:typeof u=="string"?u:JSON.stringify(u),options:l,callback:(g,$)=>g?m(g):E($)}))},ze},gt=t=>{let[e,r]=sn(),n=new Uint8Array,{readFromStdout:i,afterClose:o,service:s}=tn({writeToStdin(a){if(n.length!==0)throw new Error("Must run at most one command");n=a},isSync:!0,hasFS:!0,esbuild:Ge});t(s);let c=on.execFileSync(e,r.concat("--service=0.25.12"),{cwd:ke,windowsHide:!0,input:n,maxBuffer:+process.env.ESBUILD_MAX_BUFFER||16*1024*1024});i(c),o(null)},an=()=>Gt.join(to.tmpdir(),`esbuild-${eo.randomBytes(32).toString("hex")}`),X=null,yt=t=>{let{port1:e,port2:r}=new t.MessageChannel,n=new t.Worker(__filename,{workerData:{workerPort:r,defaultWD:ke,esbuildVersion:"0.25.12"},transferList:[r],execArgv:[]}),i=0,o=p=>{let u=new Error(`Build failed with 1 error:
error: ${p}`),l=[{id:"",pluginName:"",text:p,location:null,notes:[],detail:void 0}];return u.errors=l,u.warnings=[],u},s=p=>{if(!p)return;let u=p.plugins;if(u&&u.length>0)throw o("Cannot use plugins in synchronous API calls")},c=(p,u)=>{for(let l in u)p[l]=u[l]},a=(p,u)=>{let l=i++,E=new SharedArrayBuffer(8),m=new Int32Array(E),g={sharedBuffer:E,id:l,command:p,args:u};n.postMessage(g);let $=Atomics.wait(m,0,0);if($!=="ok"&&$!=="not-equal")throw new Error("Internal error: Atomics.wait() failed: "+$);let{message:{id:_,resolve:y,reject:x,properties:S}}=t.receiveMessageOnPort(e);if(l!==_)throw new Error(`Internal error: Expected id ${l} but got id ${_}`);if(x)throw c(x,S),x;return y};return n.unref(),{buildSync(p){return s(p),a("build",[p])},transformSync(p,u){return a("transform",[p,u])},formatMessagesSync(p,u){return a("formatMessages",[p,u])},analyzeMetafileSync(p,u){return a("analyzeMetafile",[p,u])},stop(){n.terminate(),X=null}}},xo=()=>{let t=Q.workerData.workerPort,e=Q.parentPort,r=n=>{let i={};if(n&&typeof n=="object")for(let o in n)i[o]=n[o];return i};try{let n=Ae();ke=Q.workerData.defaultWD,e.on("message",i=>{(async()=>{let{sharedBuffer:o,id:s,command:c,args:a}=i,p=new Int32Array(o);try{switch(c){case"build":t.postMessage({id:s,resolve:await n.build(a[0])});break;case"transform":t.postMessage({id:s,resolve:await n.transform(a[0],a[1])});break;case"formatMessages":t.postMessage({id:s,resolve:await n.formatMessages(a[0],a[1])});break;case"analyzeMetafile":t.postMessage({id:s,resolve:await n.analyzeMetafile(a[0],a[1])});break;default:throw new Error(`Invalid command: ${c}`)}}catch(u){t.postMessage({id:s,reject:u,properties:r(u)})}Atomics.add(p,0,1),Atomics.notify(p,0,1/0)})()})}catch(n){e.on("message",i=>{let{sharedBuffer:o,id:s}=i,c=new Int32Array(o);t.postMessage({id:s,reject:n,properties:r(n)}),Atomics.add(c,0,1),Atomics.notify(c,0,1/0)})}};Ye&&xo();var wo=Ge});var ks=process.env.JWT_SECRET||"supersecret";function As(t,e="1h"){throw new Error("JWT implementation requires external library. Install: npm install jsonwebtoken")}function js(t){throw new Error("JWT implementation requires external library. Install: npm install jsonwebtoken")}var ar=class{sessions=new Map;createSession(e,r){this.sessions.set(e,r)}getSession(e){return this.sessions.get(e)}destroySession(e){this.sessions.delete(e)}};import{mkdirSync as Vt,rmSync as vo,writeFileSync as pn,existsSync as un,copyFileSync as _o,readdirSync as So,statSync as Eo,readFileSync as $o}from"node:fs";import{join as xe}from"node:path";import{readdirSync as ni,statSync as ii}from"node:fs";import{join as lr,relative as oi,sep as si}from"node:path";function cr(t){let e=[];for(let r of ni(t)){let n=lr(t,r);ii(n).isDirectory()?e.push(...cr(n)):e.push(n)}return e}function ai(t){return t.split(si).join("/")}function li(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ci(t){let e=t.split("/").filter(Boolean),r=[];return{src:"^/"+e.map(o=>o.startsWith(":")?(r.push(o.slice(1)),"([^/]+)"):o.startsWith("*")?(r.push(o.slice(1)),"(.*)"):li(o)).join("/")+"/?$",paramNames:r}}function Ve(t){let e=lr(process.cwd(),t.siteDir),r=cr(e),n=[];for(let i of r){let o=ai(oi(e,i));if(!t.routes.fileExtensions.some(y=>o.endsWith(y)))continue;let a=o.split("/").pop().match(t.routes.routeFilePattern);if(!a)continue;let p=a[1],u=o.split("/").slice(0,-1).join("/"),l=p,E="";l==="home"?E="":l.startsWith("...")?E="*"+l.slice(3):E=l;let m="/"+(u?u+"/":"")+E;m=m.replaceAll("//","/"),l!=="home"&&!l.startsWith("...")&&/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(l);let g=p;if(g.startsWith("$")){let y=g.slice(1);m="/"+(u?u+"/":"")+":"+y,m=m.replaceAll("//","/")}g.startsWith("...")&&(m="/"+(u?u+"/":"")+"*"+g.slice(3),m=m.replaceAll("//","/")),g==="home"&&u===""&&(m="/"),g==="home"&&u!==""&&(m="/"+u);let{src:$,paramNames:_}=ci(m);n.push({id:o.replaceAll("/","_"),filePath:i,urlPath:m,pattern:$,paramNames:_})}return n.sort((i,o)=>{let s=i.urlPath.includes(":")||i.urlPath.includes("*"),c=o.urlPath.includes(":")||o.urlPath.includes("*");return s!==c?s?1:-1:i.urlPath.localeCompare(o.urlPath)}),n}import{join as pr}from"node:path";function Ls(t,...e){return pr(process.cwd(),t.siteDir,...e)}function ur(t,...e){return pr(process.cwd(),t.distDir,...e)}function Dt(){return new Date().toISOString()}var K={info(t){console.log(`[${Dt()}] [INFO] ${t}`)},warn(t){console.warn(`[${Dt()}] [WARN] ${t}`)},error(t){console.error(`[${Dt()}] [ERROR] ${t}`)}};var tt,B,gr,pi,ve,fr,yr,xr,wr,Pt,Tt,Ot,ui,Ue={},br=[],fi=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,rt=Array.isArray;function me(t,e){for(var r in e)t[r]=e[r];return t}function Mt(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function ae(t,e,r){var n,i,o,s={};for(o in e)o=="key"?n=e[o]:o=="ref"?i=e[o]:s[o]=e[o];if(arguments.length>2&&(s.children=arguments.length>3?tt.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)s[o]===void 0&&(s[o]=t.defaultProps[o]);return Qe(t,s,n,i,null)}function Qe(t,e,r,n,i){var o={type:t,props:e,key:r,ref:n,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++gr,__i:-1,__u:0};return i==null&&B.vnode!=null&&B.vnode(o),o}function ue(t){return t.children}function Xe(t,e){this.props=t,this.context=e}function De(t,e){if(e==null)return t.__?De(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?De(t):null}function vr(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return vr(t)}}function dr(t){(!t.__d&&(t.__d=!0)&&ve.push(t)&&!et.__r++||fr!=B.debounceRendering)&&((fr=B.debounceRendering)||yr)(et)}function et(){for(var t,e,r,n,i,o,s,c=1;ve.length;)ve.length>c&&ve.sort(xr),t=ve.shift(),c=ve.length,t.__d&&(r=void 0,n=void 0,i=(n=(e=t).__v).__e,o=[],s=[],e.__P&&((r=me({},n)).__v=n.__v+1,B.vnode&&B.vnode(r),Rt(e.__P,r,n,e.__n,e.__P.namespaceURI,32&n.__u?[i]:null,o,i??De(n),!!(32&n.__u),s),r.__v=n.__v,r.__.__k[r.__i]=r,Er(o,r,s),n.__e=n.__=null,r.__e!=i&&vr(r)));et.__r=0}function _r(t,e,r,n,i,o,s,c,a,p,u){var l,E,m,g,$,_,y,x=n&&n.__k||br,S=e.length;for(a=di(r,e,x,a,S),l=0;l<S;l++)(m=r.__k[l])!=null&&(E=m.__i==-1?Ue:x[m.__i]||Ue,m.__i=l,_=Rt(t,m,E,i,o,s,c,a,p,u),g=m.__e,m.ref&&E.ref!=m.ref&&(E.ref&&Nt(E.ref,null,m),u.push(m.ref,m.__c||g,m)),$==null&&g!=null&&($=g),(y=!!(4&m.__u))||E.__k===m.__k?a=Sr(m,a,t,y):typeof m.type=="function"&&_!==void 0?a=_:g&&(a=g.nextSibling),m.__u&=-7);return r.__e=$,a}function di(t,e,r,n,i){var o,s,c,a,p,u=r.length,l=u,E=0;for(t.__k=new Array(i),o=0;o<i;o++)(s=e[o])!=null&&typeof s!="boolean"&&typeof s!="function"?(typeof s=="string"||typeof s=="number"||typeof s=="bigint"||s.constructor==String?s=t.__k[o]=Qe(null,s,null,null,null):rt(s)?s=t.__k[o]=Qe(ue,{children:s},null,null,null):s.constructor===void 0&&s.__b>0?s=t.__k[o]=Qe(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):t.__k[o]=s,a=o+E,s.__=t,s.__b=t.__b+1,c=null,(p=s.__i=mi(s,r,a,l))!=-1&&(l--,(c=r[p])&&(c.__u|=2)),c==null||c.__v==null?(p==-1&&(i>u?E--:i<u&&E++),typeof s.type!="function"&&(s.__u|=4)):p!=a&&(p==a-1?E--:p==a+1?E++:(p>a?E--:E++,s.__u|=4))):t.__k[o]=null;if(l)for(o=0;o<u;o++)(c=r[o])!=null&&(2&c.__u)==0&&(c.__e==n&&(n=De(c)),kr(c,c));return n}function Sr(t,e,r,n){var i,o;if(typeof t.type=="function"){for(i=t.__k,o=0;i&&o<i.length;o++)i[o]&&(i[o].__=t,e=Sr(i[o],e,r,n));return e}t.__e!=e&&(n&&(e&&t.type&&!e.parentNode&&(e=De(t)),r.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function mi(t,e,r,n){var i,o,s,c=t.key,a=t.type,p=e[r],u=p!=null&&(2&p.__u)==0;if(p===null&&c==null||u&&c==p.key&&a==p.type)return r;if(n>(u?1:0)){for(i=r-1,o=r+1;i>=0||o<e.length;)if((p=e[s=i>=0?i--:o++])!=null&&(2&p.__u)==0&&c==p.key&&a==p.type)return s}return-1}function mr(t,e,r){e[0]=="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||fi.test(e)?r:r+"px"}function Ze(t,e,r,n,i){var o,s;e:if(e=="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof n=="string"&&(t.style.cssText=n=""),n)for(e in n)r&&e in r||mr(t.style,e,"");if(r)for(e in r)n&&r[e]==n[e]||mr(t.style,e,r[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(wr,"$1")),s=e.toLowerCase(),e=s in t||e=="onFocusOut"||e=="onFocusIn"?s.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=r,r?n?r.u=n.u:(r.u=Pt,t.addEventListener(e,o?Ot:Tt,o)):t.removeEventListener(e,o?Ot:Tt,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&r==1?"":r))}}function hr(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=Pt++;else if(e.t<r.u)return;return r(B.event?B.event(e):e)}}}function Rt(t,e,r,n,i,o,s,c,a,p){var u,l,E,m,g,$,_,y,x,S,w,b,h,C,P,N,I,d=e.type;if(e.constructor!==void 0)return null;128&r.__u&&(a=!!(32&r.__u),o=[c=e.__e=r.__e]),(u=B.__b)&&u(e);e:if(typeof d=="function")try{if(y=e.props,x="prototype"in d&&d.prototype.render,S=(u=d.contextType)&&n[u.__c],w=u?S?S.props.value:u.__:n,r.__c?_=(l=e.__c=r.__c).__=l.__E:(x?e.__c=l=new d(y,w):(e.__c=l=new Xe(y,w),l.constructor=d,l.render=gi),S&&S.sub(l),l.state||(l.state={}),l.__n=n,E=l.__d=!0,l.__h=[],l._sb=[]),x&&l.__s==null&&(l.__s=l.state),x&&d.getDerivedStateFromProps!=null&&(l.__s==l.state&&(l.__s=me({},l.__s)),me(l.__s,d.getDerivedStateFromProps(y,l.__s))),m=l.props,g=l.state,l.__v=e,E)x&&d.getDerivedStateFromProps==null&&l.componentWillMount!=null&&l.componentWillMount(),x&&l.componentDidMount!=null&&l.__h.push(l.componentDidMount);else{if(x&&d.getDerivedStateFromProps==null&&y!==m&&l.componentWillReceiveProps!=null&&l.componentWillReceiveProps(y,w),e.__v==r.__v||!l.__e&&l.shouldComponentUpdate!=null&&l.shouldComponentUpdate(y,l.__s,w)===!1){for(e.__v!=r.__v&&(l.props=y,l.state=l.__s,l.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.some(function(v){v&&(v.__=e)}),b=0;b<l._sb.length;b++)l.__h.push(l._sb[b]);l._sb=[],l.__h.length&&s.push(l);break e}l.componentWillUpdate!=null&&l.componentWillUpdate(y,l.__s,w),x&&l.componentDidUpdate!=null&&l.__h.push(function(){l.componentDidUpdate(m,g,$)})}if(l.context=w,l.props=y,l.__P=t,l.__e=!1,h=B.__r,C=0,x){for(l.state=l.__s,l.__d=!1,h&&h(e),u=l.render(l.props,l.state,l.context),P=0;P<l._sb.length;P++)l.__h.push(l._sb[P]);l._sb=[]}else do l.__d=!1,h&&h(e),u=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++C<25);l.state=l.__s,l.getChildContext!=null&&(n=me(me({},n),l.getChildContext())),x&&!E&&l.getSnapshotBeforeUpdate!=null&&($=l.getSnapshotBeforeUpdate(m,g)),N=u,u!=null&&u.type===ue&&u.key==null&&(N=$r(u.props.children)),c=_r(t,rt(N)?N:[N],e,r,n,i,o,s,c,a,p),l.base=e.__e,e.__u&=-161,l.__h.length&&s.push(l),_&&(l.__E=l.__=null)}catch(v){if(e.__v=null,a||o!=null)if(v.then){for(e.__u|=a?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,e.__e=c}else{for(I=o.length;I--;)Mt(o[I]);It(e)}else e.__e=r.__e,e.__k=r.__k,v.then||It(e);B.__e(v,e,r)}else o==null&&e.__v==r.__v?(e.__k=r.__k,e.__e=r.__e):c=e.__e=hi(r.__e,e,r,n,i,o,s,a,p);return(u=B.diffed)&&u(e),128&e.__u?void 0:c}function It(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(It)}function Er(t,e,r){for(var n=0;n<r.length;n++)Nt(r[n],r[++n],r[++n]);B.__c&&B.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){B.__e(o,i.__v)}})}function $r(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:rt(t)?t.map($r):me({},t)}function hi(t,e,r,n,i,o,s,c,a){var p,u,l,E,m,g,$,_=r.props||Ue,y=e.props,x=e.type;if(x=="svg"?i="http://www.w3.org/2000/svg":x=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(p=0;p<o.length;p++)if((m=o[p])&&"setAttribute"in m==!!x&&(x?m.localName==x:m.nodeType==3)){t=m,o[p]=null;break}}if(t==null){if(x==null)return document.createTextNode(y);t=document.createElementNS(i,x,y.is&&y),c&&(B.__m&&B.__m(e,o),c=!1),o=null}if(x==null)_===y||c&&t.data==y||(t.data=y);else{if(o=o&&tt.call(t.childNodes),!c&&o!=null)for(_={},p=0;p<t.attributes.length;p++)_[(m=t.attributes[p]).name]=m.value;for(p in _)if(m=_[p],p!="children"){if(p=="dangerouslySetInnerHTML")l=m;else if(!(p in y)){if(p=="value"&&"defaultValue"in y||p=="checked"&&"defaultChecked"in y)continue;Ze(t,p,null,m,i)}}for(p in y)m=y[p],p=="children"?E=m:p=="dangerouslySetInnerHTML"?u=m:p=="value"?g=m:p=="checked"?$=m:c&&typeof m!="function"||_[p]===m||Ze(t,p,m,_[p],i);if(u)c||l&&(u.__html==l.__html||u.__html==t.innerHTML)||(t.innerHTML=u.__html),e.__k=[];else if(l&&(t.innerHTML=""),_r(e.type=="template"?t.content:t,rt(E)?E:[E],e,r,n,x=="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,s,o?o[0]:r.__k&&De(r,0),c,a),o!=null)for(p=o.length;p--;)Mt(o[p]);c||(p="value",x=="progress"&&g==null?t.removeAttribute("value"):g!=null&&(g!==t[p]||x=="progress"&&!g||x=="option"&&g!=_[p])&&Ze(t,p,g,_[p],i),p="checked",$!=null&&$!=t[p]&&Ze(t,p,$,_[p],i))}return t}function Nt(t,e,r){try{if(typeof t=="function"){var n=typeof t.__u=="function";n&&t.__u(),n&&e==null||(t.__u=t(e))}else t.current=e}catch(i){B.__e(i,r)}}function kr(t,e,r){var n,i;if(B.unmount&&B.unmount(t),(n=t.ref)&&(n.current&&n.current!=t.__e||Nt(n,null,e)),(n=t.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(o){B.__e(o,e)}n.base=n.__P=null}if(n=t.__k)for(i=0;i<n.length;i++)n[i]&&kr(n[i],e,r||typeof t.type!="function");r||Mt(t.__e),t.__c=t.__=t.__e=void 0}function gi(t,e,r){return this.constructor(t,r)}function yi(t,e,r){var n,i,o,s;e==document&&(e=document.documentElement),B.__&&B.__(t,e),i=(n=typeof r=="function")?null:r&&r.__k||e.__k,o=[],s=[],Rt(e,t=(!n&&r||e).__k=ae(ue,null,[t]),i||Ue,Ue,e.namespaceURI,!n&&r?[r]:i?null:e.firstChild?tt.call(e.childNodes):null,o,!n&&r?r:i?i.__e:e.firstChild,n,s),Er(o,t,s)}function Lt(t,e){yi(t,e,Lt)}tt=br.slice,B={__e:function(t,e,r,n){for(var i,o,s;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),s=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,n||{}),s=i.__d),s)return i.__E=i}catch(c){t=c}throw t}},gr=0,pi=function(t){return t!=null&&t.constructor===void 0},Xe.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=me({},this.state),typeof t=="function"&&(t=t(me({},r),this.props)),t&&me(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),dr(this))},Xe.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),dr(this))},Xe.prototype.render=ue,ve=[],yr=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,xr=function(t,e){return t.__v.__b-e.__v.__b},et.__r=0,wr=/(PointerCapture)$|Capture$/i,Pt=0,Tt=hr(!1),Ot=hr(!0),ui=0;var xi="diffed",Ar="__c",Ft="__s",Ie="__c",Mr="__k",Bt="__d",Te="__s",jr=/[\s\n\\/='"\0<>]/,Cr=/^(xlink|xmlns|xml)([A-Z])/,wi=/^(?:accessK|auto[A-Z]|cell|ch|col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z])/,bi=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,vi=new Set(["draggable","spellcheck"]);function Rr(t){t.__g!==void 0?t.__g|=8:t[Bt]=!0}function _i(t){t.__g!==void 0?t.__g&=-9:t[Bt]=!1}function Dr(t){return t.__g!==void 0?!!(8&t.__g):t[Bt]===!0}var Si=/["&<]/;function nt(t){if(t.length===0||Si.test(t)===!1)return t;for(var e=0,r=0,n="",i="";r<t.length;r++){switch(t.charCodeAt(r)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 60:i="&lt;";break;default:continue}r!==e&&(n+=t.slice(e,r)),n+=i,e=r+1}return r!==e&&(n+=t.slice(e,r)),n}var Tr={},Ei=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),$i=/[A-Z]/g;function ki(t){var e="";for(var r in t){var n=t[r];if(n!=null&&n!==""){var i=r[0]=="-"?r:Tr[r]||(Tr[r]=r.replace($i,"-$&").toLowerCase()),o=";";typeof n!="number"||i.startsWith("--")||Ei.has(i)||(o="px;"),e=e+i+":"+n+o}}return e||void 0}function Or(){this.__d=!0}function Ai(t,e){return{__v:t,context:e,props:t.props,setState:Or,forceUpdate:Or,__d:!0,__h:new Array(0)}}var Ht,_e,qe,Be;var qt={},Ir=[],Oe=Array.isArray,Ut=Object.assign,Z="",it="<!--$s-->",ot="<!--/$s-->";function st(t,e,r){var n=B[Ft];B[Ft]=!0,Ht=B.__b,_e=B[xi],qe=B.__r,Be=B.unmount;var i=ae(ue,null);i[Mr]=[t];try{var o=he(t,e||qt,!1,void 0,i,!1,r);return Oe(o)?o.join(Z):o}catch(s){throw s.then?new Error('Use "renderToStringAsync" for suspenseful rendering.'):s}finally{B[Ar]&&B[Ar](t,Ir),B[Ft]=n,Ir.length=0}}function Pr(t,e){var r,n=t.type,i=!0;return t[Ie]?(i=!1,(r=t[Ie]).state=r[Te]):r=new n(t.props,e),t[Ie]=r,r.__v=t,r.props=t.props,r.context=e,Rr(r),r.state==null&&(r.state=qt),r[Te]==null&&(r[Te]=r.state),n.getDerivedStateFromProps?r.state=Ut({},r.state,n.getDerivedStateFromProps(r.props,r.state)):i&&r.componentWillMount?(r.componentWillMount(),r.state=r[Te]!==r.state?r[Te]:r.state):!i&&r.componentWillUpdate&&r.componentWillUpdate(),qe&&qe(t),r.render(r.props,r.state,e)}function he(t,e,r,n,i,o,s){if(t==null||t===!0||t===!1||t===Z)return Z;var c=typeof t;if(c!="object")return c=="function"?Z:c=="string"?nt(t):t+Z;if(Oe(t)){var a,p=Z;i[Mr]=t;for(var u=t.length,l=0;l<u;l++){var E=t[l];if(E!=null&&typeof E!="boolean"){var m,g=he(E,e,r,n,i,o,s);typeof g=="string"?p+=g:(a||(a=new Array(u)),p&&a.push(p),p=Z,Oe(g)?(m=a).push.apply(m,g):a.push(g))}}return a?(p&&a.push(p),a):p}if(t.constructor!==void 0)return Z;t.__=i,Ht&&Ht(t);var $=t.type,_=t.props;if(typeof $=="function"){var y,x,S,w=e;if($===ue){if("tpl"in _){for(var b=Z,h=0;h<_.tpl.length;h++)if(b+=_.tpl[h],_.exprs&&h<_.exprs.length){var C=_.exprs[h];if(C==null)continue;typeof C!="object"||C.constructor!==void 0&&!Oe(C)?b+=C:b+=he(C,e,r,n,t,o,s)}return b}if("UNSTABLE_comment"in _)return"<!--"+nt(_.UNSTABLE_comment)+"-->";x=_.children}else{if((y=$.contextType)!=null){var P=e[y.__c];w=P?P.props.value:y.__}var N=$.prototype&&typeof $.prototype.render=="function";if(N)x=Pr(t,w),S=t[Ie];else{t[Ie]=S=Ai(t,w);for(var I=0;Dr(S)&&I++<25;){_i(S),qe&&qe(t);try{x=$.call(S,_,w)}catch(R){throw o&&R&&typeof R.then=="function"&&(t._suspended=!0),R}}Rr(S)}if(S.getChildContext!=null&&(e=Ut({},e,S.getChildContext())),N&&B.errorBoundaries&&($.getDerivedStateFromError||S.componentDidCatch)){x=x!=null&&x.type===ue&&x.key==null&&x.props.tpl==null?x.props.children:x;try{return he(x,e,r,n,t,o,!1)}catch(R){return $.getDerivedStateFromError&&(S[Te]=$.getDerivedStateFromError(R)),S.componentDidCatch&&S.componentDidCatch(R,qt),Dr(S)?(x=Pr(t,e),(S=t[Ie]).getChildContext!=null&&(e=Ut({},e,S.getChildContext())),he(x=x!=null&&x.type===ue&&x.key==null&&x.props.tpl==null?x.props.children:x,e,r,n,t,o,s)):Z}finally{_e&&_e(t),Be&&Be(t)}}}x=x!=null&&x.type===ue&&x.key==null&&x.props.tpl==null?x.props.children:x;try{var d=he(x,e,r,n,t,o,s);return _e&&_e(t),B.unmount&&B.unmount(t),t._suspended?typeof d=="string"?it+d+ot:Oe(d)?(d.unshift(it),d.push(ot),d):d.then(function(R){return it+R+ot}):d}catch(R){if(!o&&s&&s.onError){var v=(function U(H){return s.onError(H,t,function(J,W){try{return he(J,e,r,n,W,o,s)}catch(se){return U(se)}})})(R);if(v!==void 0)return v;var T=B.__e;return T&&T(R,t),Z}if(!o||!R||typeof R.then!="function")throw R;return R.then(function U(){try{var H=he(x,e,r,n,t,o,s);return t._suspended?it+H+ot:H}catch(J){if(!J||typeof J.then!="function")throw J;return J.then(U)}})}}var L,F="<"+$,M=Z;for(var k in _){var j=_[k];if(typeof(j=Ci(j)?j.value:j)!="function"||k==="class"||k==="className"){switch(k){case"children":L=j;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in _)continue;k="for";break;case"className":if("class"in _)continue;k="class";break;case"defaultChecked":k="checked";break;case"defaultSelected":k="selected";break;case"defaultValue":case"value":switch(k="value",$){case"textarea":L=j;continue;case"select":n=j;continue;case"option":n!=j||"selected"in _||(F+=" selected")}break;case"dangerouslySetInnerHTML":M=j&&j.__html;continue;case"style":typeof j=="object"&&(j=ki(j));break;case"acceptCharset":k="accept-charset";break;case"httpEquiv":k="http-equiv";break;default:if(Cr.test(k))k=k.replace(Cr,"$1:$2").toLowerCase();else{if(jr.test(k))continue;k[4]!=="-"&&!vi.has(k)||j==null?r?bi.test(k)&&(k=k==="panose1"?"panose-1":k.replace(/([A-Z])/g,"-$1").toLowerCase()):wi.test(k)&&(k=k.toLowerCase()):j+=Z}}j!=null&&j!==!1&&(F=j===!0||j===Z?F+" "+k:F+" "+k+'="'+(typeof j=="string"?nt(j):j+Z)+'"')}}if(jr.test($))throw new Error($+" is not a valid HTML tag name in "+F+">");if(M||(typeof L=="string"?M=nt(L):L!=null&&L!==!1&&L!==!0&&(M=he(L,e,$==="svg"||$!=="foreignObject"&&r,n,t,o,s))),_e&&_e(t),Be&&Be(t),!M&&ji.has($))return F+"/>";var q="</"+$+">",A=F+">";return Oe(M)?[A].concat(M,[q]):typeof M!="string"?[A,M,q]:A+M+q}var ji=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),zt=st;function Ci(t){return t!==null&&typeof t=="object"&&typeof t.peek=="function"&&"value"in t}var cn=Ct(xt(),1);import{pathToFileURL as bo}from"node:url";async function wt(t){let{config:e,route:r,url:n,params:i,query:o,headers:s,cookies:c}=t,a=r.filePath;if(r.filePath.endsWith(".tsx")||r.filePath.endsWith(".ts")){let S=await cn.default.build({entryPoints:[r.filePath],outfile:r.filePath.replace(/\.(tsx?|jsx?)$/,".esbuild.mjs"),format:"esm",platform:"browser",target:"es2022",bundle:!1,write:!0});a=r.filePath.replace(/\.(tsx?|jsx?)$/,".esbuild.mjs")}let p=await import(bo(a).href),u={url:n,params:i,query:o,headers:s,cookies:c},l=null;typeof p.loader=="function"&&(l=await p.loader(u));let E=p.default,m=ae(E,{data:l,params:i,query:o}),g=st(m),$=[];if($.push(...e.inject.head),p.Head)try{let S=ae(p.Head,{data:l,params:i,query:o}),w=st(S);$.push(w)}catch{}$.push('<link rel="stylesheet" href="/styles.css">');let _=JSON.stringify({data:l,params:i,query:o},null,2).replace(/<\/script/g,"<\\/script"),y=r.urlPath==="/"?"route_index":`route_${r.urlPath.slice(1).replace(/\//g,"_")}`;return`<!doctype html>
<html>
<head>
${$.join(`
`)}
</head>
<body>
<div id="app">${g}</div>
<script id="__FRAMEWORK_DATA__" type="application/json">
${_}
</script>
<script type="module">
  import { hydrateClient } from "/__runtime/hydrate.js";
  hydrateClient(${JSON.stringify(`/__hydrate?id=${y}`)});
</script>
${e.inject.bodyEnd.join(`
`)}
</body>
</html>`}function fn(t,e){if(un(t)){Vt(e,{recursive:!0});for(let r of So(t)){let n=xe(t,r),i=xe(e,r);Eo(n).isDirectory()?fn(n,i):_o(n,i)}}}function ko(t){return un(t)?`/* SCSS placeholder (compile later in Rust) */
/*
${$o(t,"utf8")}
*/
`:`/* no global scss */
`}async function na(t){let{config:e}=t,r=ur(e);vo(r,{recursive:!0,force:!0}),Vt(r,{recursive:!0});let n=Ve(e);K.info(`Building SSG: ${n.length} routes`);for(let o of n){let s=new URL("http://localhost"+o.urlPath),c=await wt({config:e,route:o,url:s,params:{},query:{},headers:{},cookies:{}}),a=o.urlPath==="/"?xe(r,"index.html"):xe(r,o.urlPath.slice(1),"index.html");Vt(xe(a,".."),{recursive:!0}),pn(a,c,"utf8"),K.info(`SSG: ${o.urlPath} -> ${a}`)}fn(xe(process.cwd(),e.siteDir,"assets"),xe(r,"assets"));let i=ko(xe(process.cwd(),e.css.globalScss));pn(xe(r,"styles.css"),i,"utf8"),K.info("Build complete.")}import{createHash as Ao}from"node:crypto";import{writeFileSync as dn,mkdirSync as Zt}from"node:fs";import{join as bt}from"node:path";var vt=class{assets=new Map;assetMap={};distDir;constructor(e){this.distDir=e,Zt(bt(e,"_assets"),{recursive:!0})}computeHash(e){return Ao("sha256").update(e).digest("hex").slice(0,16)}registerAsset(e,r,n){let i=this.computeHash(r),c=`_assets/${`${i}${e==="css"?".css":e==="js"?".js":".html"}`}`;return this.assets.set(c,{path:c,content:r,hash:i,type:e}),n&&(this.assetMap[n]=c),c}buildCriticalCss(e,r){let n=new Set,i=e,o=/class="([^"]*)"/g,s;for(;s=o.exec(i);)s[1].split(/\s+/).forEach(u=>n.add(`.${u}`));let c=/id="([^"]*)"/g;for(;s=c.exec(i);)n.add(`#${s[1]}`);let a=/<(\w+)/g;for(;s=a.exec(i);)n.add(s[1]);let p=this.extractCss(r,n);return this.minifyCss(p)}extractCss(e,r){let n=[],i=/([^{]+)\{([^}]+)\}/g,o;for(;o=i.exec(e);){let s=o[1].trim(),c=o[2].trim();s.split(",").some(a=>{let p=a.trim();return Array.from(r).some(u=>p.includes(u)||u.includes(p))})&&n.push(`${s}{${c}}`)}return n.join("")}minifyHtml(e){return e.replace(/<!--[\s\S]*?-->/g,"").replace(/\s+/g," ").replace(/>\s+</g,"><").replace(/\s+([=:])\s+/g,"$1").trim()}minifyCss(e){return e.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").replace(/\s*([{};:,])\s*/g,"$1").trim()}minifyJs(e){return e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").replace(/\s*([=+\-*/%<>!&|^~?:()[\]{},.;])\s*/g,"$1").trim()}buildPage(e,r,n,i,o){let s=this.minifyHtml(r),c=this.buildCriticalCss(s,n),a=this.minifyCss(n.replace(c,"")),p=this.registerAsset("css",a,"styles.css"),u=i?this.registerAsset("js",this.minifyJs(i),"runtime.js"):"",l=JSON.stringify(o).replace(/\s/g,""),E=JSON.stringify(this.assetMap).replace(/\s/g,""),m=this.buildHydrationScript(u,l),g=this.injectAssets(s,c,p,m,l);return{path:e,html:g,criticalCss:c,assets:Array.from(this.assets.values()),frameworkData:o}}buildHydrationScript(e,r){let n=`
      <script>
        window.__FRAMEWORK_DATA__=${r};
        window.__ASSET_MAP__=${JSON.stringify(this.assetMap)};
      </script>
      ${e?`<link rel="preload" href="/${e}" as="script"><script src="/${e}" defer></script>`:""}
    `;return this.minifyJs(n)}injectAssets(e,r,n,i,o){let s=`<style>${r}</style><link rel="preload" href="/${n}" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/${n}"></noscript>`,c=`<script>window.__FRAMEWORK_DATA__=${o};</script>${i}`,a=e.match(/<\/head>/i),p=e.match(/<\/body>/i),u=e;return a?u=u.replace(/<\/head>/i,`${s}</head>`):u=s+u,p?u=u.replace(/<\/body>/i,`${c}</body>`):u=u+c,u}writeAssets(){this.assets.forEach(e=>{let r=bt(this.distDir,e.path);Zt(bt(this.distDir,"_assets"),{recursive:!0}),dn(r,e.content)})}writePage(e,r){let n=bt(this.distDir,e),i=n.substring(0,n.lastIndexOf("\\")||n.lastIndexOf("/"));Zt(i,{recursive:!0}),dn(n,r)}getAssetMap(){return this.assetMap}};import{readFileSync as To,writeFileSync as hn}from"node:fs";import{join as St}from"node:path";import{createHash as jo}from"node:crypto";import{writeFileSync as Co,readFileSync as Do}from"node:fs";var _t=class{entries=new Map;manifestPath;constructor(e){this.manifestPath=e,this.loadManifest()}loadManifest(){try{let e=Do(this.manifestPath,"utf-8"),r=JSON.parse(e);Object.entries(r).forEach(([n,i])=>{this.entries.set(n,i)})}catch{}}addAsset(e,r,n){let i=this.computeHash(r),o=this.getExtension(n),s=`${this.stripExt(e)}.${i}${o}`,c=typeof r=="string"?Buffer.byteLength(r):r.length;return this.entries.set(e,{original:e,hashed:s,hash:i,size:c,type:n,mtime:Date.now()}),s}computeHash(e){return jo("sha256").update(e).digest("hex").slice(0,12)}getExtension(e){return e==="js"?".js":e==="css"?".css":".html"}stripExt(e){return e.replace(/\.(js|css|html)$/,"")}getHashedName(e){return this.entries.get(e)?.hashed??null}getEntry(e){return this.entries.get(e)??null}getAllEntries(){return Array.from(this.entries.values())}saveManifest(){let e={};this.entries.forEach((r,n)=>{e[n]=r}),Co(this.manifestPath,JSON.stringify(e,null,2))}toDeterministicJson(){let e=Array.from(this.entries.values()).sort((r,n)=>r.original.localeCompare(n.original));return JSON.stringify(e)}};function mn(t){let e=[],r=/data-island="([^"]+)"/g,n;for(;n=r.exec(t);){let i=n[1],o=t.substring(t.lastIndexOf("<div",n.index),n.index+100),s=o.match(/id="([^"]+)"/);if(s){let c=s[1],a=o.match(/<script[^>]*>(.*?)<\/script>/s),p=a?JSON.parse(a[1]):{};e.push({id:c,name:i,props:p})}}return e}function Qt(){return new Date().toISOString()}var ce={info(t){console.log(`[${Qt()}] [INFO] ${t}`)},warn(t){console.warn(`[${Qt()}] [WARN] ${t}`)},error(t){console.error(`[${Qt()}] [ERROR] ${t}`)}};var gn=class{config;builder;manifest;pages=new Map;startTime=0;constructor(e){this.config=e,this.builder=new vt(e.distDir),this.manifest=new _t(St(e.distDir,"manifest.json")),this.startTime=Date.now()}async buildPages(e){ce.info(`[SSG] Building ${e.size} pages...`);for(let[n,i]of e)await this.buildPage(n,i);this.builder.writeAssets(),this.manifest.saveManifest();let r=Date.now()-this.startTime;ce.info(`[SSG] Build complete in ${r}ms`)}async buildPage(e,r){let n=r.default,i=r.Head;if(!n){ce.warn(`[SSG] No default export in ${e}`);return}let o=this.renderComponentStatic(n),s=mn(o),c={route:e,islands:s,timestamp:Date.now(),buildVersion:"1.0.0"},a=this.loadGlobalStyles(),p=this.builder.buildPage(e,o,a,"",c),u=this.getOutputPath(e);this.builder.writePage(u,p.html),this.pages.set(e,p.html),ce.info(`[SSG] \u2713 ${e} \u2192 ${u}`)}renderComponentStatic(e){return`<div>${e?.name||"Component"}</div>`}loadGlobalStyles(){try{let e=this.config.css?.globalScss||"";return e?To(St(this.config.siteDir,e),"utf-8"):""}catch{return""}}getOutputPath(e){return e==="/"||e===""?"index.html":e.replace(/^\//,"").replace(/\/$/,"")+"/index.html"}generateSitemap(e){return`<?xml version="1.0" encoding="UTF-8"?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
${Array.from(this.pages.keys()).map(n=>`  <url><loc>${new URL(n,e).href}</loc><lastmod>${new Date().toISOString()}</lastmod></url>`).join(`
`)}
</urlset>`}generateRobotsTxt(){return`User-agent: *
Allow: /
Disallow: /_assets/
Disallow: /.*

Sitemap: /sitemap.xml`}writeSitemap(e){let r=this.generateSitemap(e);hn(St(this.config.distDir,"sitemap.xml"),r),ce.info("[SSG] \u2713 sitemap.xml generated")}writeRobotsTxt(){let e=this.generateRobotsTxt();hn(St(this.config.distDir,"robots.txt"),e),ce.info("[SSG] \u2713 robots.txt generated")}getStats(){return{pages:this.pages.size,assets:this.manifest.getAllEntries().length,duration:Date.now()-this.startTime}}};import{writeFileSync as Ke,mkdirSync as xn}from"node:fs";import{join as Le}from"node:path";import{createHash as Oo}from"node:crypto";var Et=class{entries=new Map;HASH_LENGTH=12;hashContent(e){return Oo("sha256").update(e).digest("hex").slice(0,this.HASH_LENGTH)}registerAsset(e,r,n){let i=this.hashContent(r),o=this.getExtension(e),c=`${this.stripExtension(n)}.${i}${o}`,a=typeof r=="string"?Buffer.byteLength(r):r.length;return this.entries.set(n,{original:n,hashed:c,hash:i,type:e,size:a,immutable:e!=="html"}),c}getHashedPath(e){return this.entries.get(e)?.hashed??null}getEntry(e){return this.entries.get(e)??null}getAllEntries(){return Array.from(this.entries.values())}getManifest(){let e={};return this.entries.forEach(r=>{e[r.original]=r.hashed}),e}stripExtension(e){return e.replace(/\.(css|js|html|png|jpg|gif|woff|woff2)$/,"")}getExtension(e){return{css:".css",js:".js",media:".bin",html:".html"}[e]||""}};function _a(t,e){let r=t;return Object.entries(e).forEach(([n,i])=>{r=r.replace(new RegExp(`href=["']${n}["']`,"g"),`href="${i}"`),r=r.replace(new RegExp(`src=["']${n}["']`,"g"),`src="${i}"`)}),r}function Sa(t,e=31536e3){return t?{"Cache-Control":`public, max-age=${e}, immutable`,Expires:new Date(Date.now()+e*1e3).toUTCString()}:{"Cache-Control":"public, max-age=3600",Expires:new Date(Date.now()+36e5).toUTCString()}}var Ea={HASH_LENGTH:12,ENTRY_ASSETS:["index.html","*.html"],NON_ENTRY_ASSETS:["*.css","*.js","*.woff2","*.png","*.jpg"],HASH_ALGORITHM:"SHA256",IMMUTABLE_TYPES:["css","js","media"],MUTABLE_TYPES:["html"]};function Xt(){let t=new Map;return{islands:t,register(e,r,n){if(t.has(e))throw new Error(`ISLAND: Duplicate island ID: ${e}`);t.set(e,{id:e,component:r,props:n})},get(e){return t.get(e)??null},getAll(){return Array.from(t.values())},validate(){let e=new Set;t.forEach(({id:n})=>{if(e.has(n))throw new Error(`ISLAND: Duplicate island ID: ${n}`);e.add(n)});let r=["body","main","html","document"];t.forEach(({component:n,id:i})=>{if(r.includes(n.toLowerCase()))throw new Error(`ISLAND: Cannot hydrate ${n} element (${i})`)})}}}function Io(t,e,r){let n=JSON.stringify(r).replace(/\s/g,"");return`<div id="${t}" data-island="${e}"><script type="application/json">${n}</script></div>`}function Po(t){if(t.length===0)return"(function(){})();";let e=JSON.stringify(t).replace(/\s/g,"");return`(function(){
const d=window.__FRAMEWORK_DATA__||{};
const i=d.islands||[];
i.forEach(s=>{
const e=document.getElementById(s.id);
if(!e)return;
const j=e.querySelector('script[type="application/json"]');
if(!j)return;
const p=JSON.parse(j.textContent);
e.dataset.hydrated='true';
e.dataset.component=s.component;
window.dispatchEvent(new CustomEvent('island:hydrated',{detail:{id:s.id,component:s.component,props:p}}))
})
})();`}function Mo(t){let e=[],r=/id="([^"]*)"[^>]*data-island="([^"]*)"/g,n;for(;n=r.exec(t);){let i=n[1],o=n[2],s=t.indexOf("<script",n.index),c=t.indexOf("</script>",s),p=t.substring(s,c).match(/<script[^>]*type="application\/json"[^>]*>(.*?)<\/script>/s);if(p)try{let u=JSON.parse(p[1]);e.push({id:i,component:o,props:u})}catch{}}return e}function Ro(t,e){let n=Po(e).replace(/\s+/g," ").trim(),i=t.lastIndexOf("</body>");return i===-1?t+`<script>${n}</script>`:t.slice(0,i)+`<script>${n}</script>`+t.slice(i)}function No(t,e){let n=`<script>window.__FRAMEWORK_DATA__=${JSON.stringify(e).replace(/\s/g,"")}</script>`,i=t.lastIndexOf("</body>");return i===-1?t+n:t.slice(0,i)+n+t.slice(i)}var ka={allowOptIn:!0,forbiddenElements:["body","main","html","document"],dataSource:"single",noRefetching:!0,requiredAttribute:"data-island"};var we=class{static enforceSSGPurity(e){if(/import\s*\(/gm.test(e))throw new Error("SSG: Dynamic imports forbidden");if(/eval\(/gm.test(e))throw new Error("SSG: eval() forbidden");if(/<[^>]*\sonload=/gm.test(e)&&!e.includes("defer"))throw new Error("SSG: Render-blocking event handlers")}static enforceDeterminism(e,r){if(/Date\.now\(\)/gm.test(e))throw new Error("BUILD: Date.now() in output");if(/Math\.random\(\)/gm.test(e))throw new Error("BUILD: Math.random() in output");if(/\bcrypto\.getRandomValues/gm.test(e))throw new Error("BUILD: crypto.getRandomValues() in output");if(JSON.stringify(r).includes("undefined"))throw new Error("BUILD: Undefined in framework data")}static enforceMinification(e,r,n){if(/>\s\s+</gm.test(e))throw new Error("MINIFY: Excess whitespace in HTML");if(/<!--.*?-->/gm.test(e))throw new Error("MINIFY: Comments in HTML output");if(/\/\*.*?\*\//gm.test(r))throw new Error("MINIFY: Comments in CSS output");if(/\{\s+/gm.test(r))throw new Error("MINIFY: Excess spaces in CSS");if(/\/\/.*$/gm.test(n)||/\/\*.*?\*\//gm.test(n))throw new Error("MINIFY: Comments in JS output")}static enforceAssetHashing(e,r){if(["index.html","style.css","app.js"].some(i=>e.includes(i))){if(!e.match(/\.[a-f0-9]{12}\./))throw new Error(`HASH: Entry asset must not be hashed: ${e}`)}else if(!e.match(/\.[a-f0-9]{12}\./))throw new Error(`HASH: Non-entry asset missing hash: ${e}`);if(r.toString().includes("Math.random")||r.toString().includes("Date.now"))throw new Error("HASH: Asset contains non-deterministic values")}static enforceCssStrategy(e,r){let n=Buffer.byteLength(e,"utf8");if(n>4096)throw new Error(`CSS: Inline CSS exceeds 4KB (${n} bytes)`);if(r.includes('<link rel="stylesheet"')&&!r.includes("onload"))throw new Error("CSS: External stylesheet missing onload pattern")}static enforceIslandHydration(e){(e.match(/id="[^"]*island[^"]*"/gm)||[]).forEach(i=>{let o=i.match(/id="([^"]*)"/)?.[1];if(o&&!e.includes("data-island="))throw new Error(`ISLAND: Island ${o} missing data-island attribute`)}),["<body","<main","<html"].forEach(i=>{if(e.includes(`${i}`)&&e.match(new RegExp(`${i}[^>]*data-island`)))throw new Error(`ISLAND: Cannot hydrate ${i} element`)})}static enforceFrameworkData(e){try{JSON.parse(e)}catch{throw new Error("DATA: Invalid JSON in FRAMEWORK_DATA")}let r=JSON.parse(e);if(r.islands){let n=new Set;r.islands.forEach(i=>{if(n.has(i.id))throw new Error(`DATA: Duplicate island id: ${i.id}`);n.add(i.id)})}if(e.includes(" ")||e.includes(`
`))throw new Error("DATA: FRAMEWORK_DATA not minified")}static enforceDevProdSeparation(e){[/console\.(log|warn|error|debug)/gm,/debugger/gm,/process\.env\.NODE_ENV\s*===\s*['"]development['"]/gm,/__DEV__/gm].forEach(n=>{if(n.test(e))throw new Error("DEV: Development code detected in production output")})}static enforceSEOOutput(e,r,n){if(n.forEach(i=>{if(!e.includes(i))throw new Error(`SEO: Page missing from sitemap: ${i}`)}),!r.includes("User-agent:")||!r.includes("Sitemap:"))throw new Error("SEO: Invalid robots.txt")}static verifyHTMLSemantics(e){if(!e.startsWith("<!DOCTYPE html>"))throw new Error("HTML: Missing DOCTYPE");if(!/<head[^>]*>/.test(e))throw new Error("HTML: Missing head element");if(!/<body[^>]*>/.test(e))throw new Error("HTML: Missing body element");if(!/<title[^>]*>[^<]*<\/title>/i.test(e))throw new Error("HTML: Missing title element")}static reportViolation(e,r){throw new Error(`[INVARIANT VIOLATION] ${e}: ${r}`)}},ja=["SSG-001: Output must be 100% static HTML with no runtime assumptions","SSG-002: No client-side routing or SPA architecture allowed","SSG-003: All content must be functional without JavaScript","DET-001: Same input must produce byte-identical output","DET-002: No timestamps, random values, or non-deterministic data in output","DET-003: Build output is deterministically reproducible","MIN-001: HTML must be fully minified (no excess whitespace, comments, formatting)","MIN-002: All inline CSS must be minified","MIN-003: All external CSS must be minified","MIN-004: All JavaScript must be minified","MIN-005: All embedded JSON must be minified","HASH-001: Non-entry assets must have content-based hash in filename","HASH-002: Page HTML files must NOT be hashed","HASH-003: Asset hashes must use SHA-256, truncated to 12 characters","HASH-004: HTML must reference assets via generated manifest","CSS-001: Inline critical CSS must not exceed 4KB minified","CSS-002: Critical CSS must be above-the-fold content only","CSS-003: Non-critical CSS must be external with preload + onload pattern","CSS-004: Non-critical CSS must have noscript fallback","CSS-005: No render-blocking stylesheets allowed","ISLAND-001: Hydration is opt-in via data-island attribute only","ISLAND-002: Never hydrate page-level containers (body, main, html)","ISLAND-003: Only interactive components may hydrate","ISLAND-004: Static content must never hydrate","DATA-001: FRAMEWORK_DATA must be embedded in HTML, minified","DATA-002: Island props must have single source of truth","DATA-003: No duplicate island IDs allowed","DATA-004: No client-side data refetching allowed","DEV-001: SSR must not be bundled into production output","DEV-002: No development console.log, debugger, or __DEV__ code in output","DEV-003: Dev server is separate from production pipeline","OUTPUT-001: HTML must be semantic and accessible","OUTPUT-002: SEO metadata must be intact","OUTPUT-003: sitemap.xml must be generated deterministically","OUTPUT-004: robots.txt must be valid and complete","OUTPUT-005: Output must be framework-agnostic, standards-only HTML","FORBID-001: No React/Next/Vue conventions in output","FORBID-002: No virtual DOM runtime in output","FORBID-003: No runtime templating in output","FORBID-004: No build artifacts in output"];var je=class{static html(e){return e.replace(/<!--[\s\S]*?-->/g,"").replace(/>\s+</g,"><").replace(/\s+/g," ").replace(/\s*([{};:,=])\s*/g,"$1").trim()}static css(e){return e.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*/g,"").replace(/\s*([{}:;,])\s*/g,"$1").replace(/\s+/g," ").replace(/;\s*}/g,"}").trim()}static js(e){return e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").replace(/\s*([+\-*/%=<>!&|^~?:()[\]{},.;])\s*/g,"$1").replace(/;\s+}/g,"}").trim()}static json(e){return JSON.stringify(e).replace(/\s/g,"")}static inline(e,r){return{css:this.css(e),js:this.js(r)}}};function Da(t){return t.replace(/\/\*[\s\S]*?\*\//g,"").trim()}function Ta(t){return t.split(`
`).map(e=>{let r=e.indexOf("//");return r===-1?e:e.substring(0,r)}).join(`
`).replace(/\/\*[\s\S]*?\*\//g,"").trim()}function Oa(t){return t.replace(/\s+/g," ").replace(/>\s+</g,"><").replace(/\s+([=:])/g,"$1").replace(/([=:])\s+/g,"$1").trim()}function Ia(t){return JSON.stringify(t).replace(/\s/g,"")}function Lo(){let t={extract(e,r){let n=t.extractSelectors(e);return t.filterCss(r,n)},extractSelectors(e){let r=new Set,n=/class="([^"]*)"/g,i;for(;i=n.exec(e);)i[1].split(/\s+/).forEach(a=>{a&&r.add(`.${a}`)});let o=/id="([^"]*)"/g;for(;i=o.exec(e);)r.add(`#${i[1]}`);let s=/<(\w+)[^>]*>/g;for(;i=s.exec(e);)r.add(i[1]);let c=/data-([a-z-]+)/g;for(;i=c.exec(e);)r.add(`[data-${i[1]}]`);return r},filterCss(e,r){let n=[],i=Array.from(r),o=/([^{]+)\{([^}]+)\}/g,s;for(;s=o.exec(e);){let c=s[1].trim(),a=s[2].trim();c.split(",").map(u=>u.trim()).some(u=>t.selectorMatches(u,i))&&n.push(`${c}{${a}}`)}return n.join("")},selectorMatches(e,r){if(e==="*")return!0;let n=e.split(/::/)[0];return r.some(i=>i===e?!0:i.startsWith(".")||i.startsWith("#")?n.includes(i):e===i?!0:n===i)}};return t}function yn(t,e){return Lo().extract(t,e)}var wn=class{hasher;ctx;pages=new Map;startTime=0;constructor(e){this.ctx={config:e,distDir:e.distDir,hashSeed:process.env.BUILD_SEED||"jen-ssg-v1"},this.hasher=new Et,this.startTime=Date.now()}async buildPage(e){let{path:r,html:n,css:i,js:o}=e,s=je.html(n),c=je.css(i),a=je.js(o);we.enforceSSGPurity(s),we.enforceDevProdSeparation(a);let p=yn(s,c),u=je.css(p),l=Buffer.byteLength(u),E=u,m=c;l>4096&&(ce.warn(`[SSG] Critical CSS exceeded 4KB (${l}b), using external CSS`),E="",m=c);let g=this.hasher.registerAsset("css",m,"styles.css"),$=a?this.hasher.registerAsset("js",a,"runtime.js"):"",_={route:r,islands:[],buildSeed:this.ctx.hashSeed,version:"1.0.0"};we.enforceDeterminism(s,_),we.enforceFrameworkData(JSON.stringify(_));let y=s;if(E){let I=`<style>${E}</style>`,d=y.indexOf("</head>");d!==-1&&(y=y.slice(0,d)+I+y.slice(d))}let x=`<link rel="preload" href="/${g}" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="/${g}"></noscript>`,S=y.indexOf("</head>");S!==-1&&(y=y.slice(0,S)+x+y.slice(S));let b=`<script>window.__FRAMEWORK_DATA__=${JSON.stringify(_).replace(/\s/g,"")}</script>`,h=y.lastIndexOf("</body>");h!==-1&&(y=y.slice(0,h)+b+y.slice(h));let C=Xt();if(C.validate(),C.getAll().length>0){let I=`<script>(function(){const d=window.__FRAMEWORK_DATA__||{};const i=d.islands||[];i.forEach(s=>{const e=document.getElementById(s.id);if(!e)return;const j=e.querySelector('script[type="application/json"]');if(!j)return;const p=JSON.parse(j.textContent);e.dataset.hydrated='true'})})();</script>`,d=y.lastIndexOf("</body>");d!==-1&&(y=y.slice(0,d)+I+y.slice(d))}we.verifyHTMLSemantics(y),we.enforceMinification(y,m,a),this.pages.set(r,y);let N=[{path:g,content:m}];return $&&N.push({path:$,content:a}),{path:r,html:y,assets:N}}writeOutput(e){let r=Le(this.ctx.distDir,e.path.replace(/\.tsx?$/,"/index.html"));xn(Le(this.ctx.distDir,"_assets"),{recursive:!0});let n=r.substring(0,Math.max(r.lastIndexOf("\\"),r.lastIndexOf("/")));xn(n,{recursive:!0}),Ke(r,e.html),e.assets.forEach(({path:i,content:o})=>{let s=Le(this.ctx.distDir,"_assets",i);Ke(s,o)}),ce.info(`[SSG] \u2713 ${e.path} (${Buffer.byteLength(e.html)}b)`)}generateSitemap(e){return`<?xml version="1.0" encoding="UTF-8"?><urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">${Array.from(this.pages.keys()).map(n=>`<url><loc>${new URL(n==="/"?"/":n.replace(/\.tsx?$/,"/"),e).href}</loc></url>`).join("")}</urlset>`}generateRobotsTxt(){return`User-agent:*
Allow:/
Disallow:/_assets/
Sitemap:/sitemap.xml`}writeFinalAssets(e){let r=this.generateSitemap(e),n=this.generateRobotsTxt();Ke(Le(this.ctx.distDir,"sitemap.xml"),r),Ke(Le(this.ctx.distDir,"robots.txt"),n);let i=this.hasher.getManifest();Ke(Le(this.ctx.distDir,"manifest.json"),JSON.stringify(i,null,2)),ce.info("[SSG] \u2713 sitemap.xml, robots.txt, manifest.json")}getStats(){return{pages:this.pages.size,assets:this.hasher.getAllEntries().length,duration:Date.now()-this.startTime}}};async function Ga(t,e){let n=zt(ae(t,{})).toString(),i="",o=n,s={},c=t;return c.Head&&(i=zt(ae(c.Head,{})).toString()),n=n.replace(/<script[^>]*>[\s\S]*?<\/script>/g,""),n=n.replace(/data-client-only/g,""),{html:n,head:i,body:o,data:s}}function Ya(t,e,r=[],n=[],i={}){let o=`<script>window.__FRAMEWORK_DATA__=${JSON.stringify(i)}</script>`;return`<!DOCTYPE html>
<html>
<head>
${e}
${r.join(`
`)}
</head>
<body>
${t}
${n.join(`
`)}
${o}
</body>
</html>`}function Ka(t){t=t.replace(/data:text\/html/gi,"data:text/plain"),t=t.replace(/\s+on[a-z]+\s*=\s*"[^"]*"/gi,"");let e=["id","class","data-","href","src","alt","title","width","height","aria-"];return t}var bn=`(function(){const d=window.__FRAMEWORK_DATA__||{};const i=d.islands||[];i.forEach(s=>{const e=document.getElementById(s.id);if(!e)return;const j=e.querySelector('script[type="application/json"]');if(!j)return;const p=JSON.parse(j.textContent);e.dataset.hydrated='true';e.dataset.component=s.name;window.dispatchEvent(new CustomEvent('island:ready',{detail:{id:s.id,name:s.name,props:p}}))})})();`,Za=(t,e="style")=>`<link rel="preload" href="${t}" as="${e}">`,Fo=t=>`<link rel="preload" href="${t}" as="style" onload="this.onload=null;this.rel='stylesheet'"><noscript><link rel="stylesheet" href="${t}"></noscript>`,Qa=t=>`<script>window.__FRAMEWORK_DATA__=${JSON.stringify(t).replace(/\s/g,"")}</script>`,Xa=t=>`<script>window.__ASSET_MAP__=${JSON.stringify(t).replace(/\s/g,"")}</script>`;function el(t){return`<script>window.__SSG_CONFIG__=${JSON.stringify(t).replace(/\s/g,"")}</script>`}function Ho(t){return t.length===0?`<script>${bn}</script>`:`<script>
window.__ISLANDS__=${JSON.stringify(t).replace(/\s/g,"")};
${bn}
</script>`}function tl(t,e){let r=`<style>${e}</style>`,n=t.indexOf("</head>");return n===-1?r+t:t.slice(0,n)+r+t.slice(n)}function rl(t,e){let r=Fo(e),n=t.indexOf("</head>");return n===-1?t+r:t.slice(0,n)+r+t.slice(n)}function nl(t,e){let r=Ho(e),n=t.lastIndexOf("</body>");return n===-1?t+r:t.slice(0,n)+r+t.slice(n)}function il(t,e){let r=`<img src="https://analytics.example.com/pixel?id=${e}" alt="" width="1" height="1" style="display:none">`,n=t.lastIndexOf("</body>");return n===-1?t+r:t.slice(0,n)+r+t.slice(n)}import{createHash as vn}from"node:crypto";var _n=class{state={fileHashes:new Map,contentHash:"",timestamp:0};addContent(e,r){let n=this.hashContent(r);this.state.fileHashes.set(e,n)}hashContent(e){return vn("sha256").update(e).digest("hex")}computeOverallHash(){let e=Array.from(this.state.fileHashes.entries()).sort(([r],[n])=>r.localeCompare(n)).map(([r,n])=>`${r}:${n}`).join(`
`);return vn("sha256").update(e).digest("hex")}getState(){return{...this.state,contentHash:this.computeOverallHash(),timestamp:Date.now()}}isDeterministic(e){return this.computeOverallHash()===e.contentHash}normalizeTimestamps(e){return e.replace(/("timestamp":\d+)|("mtime":\d+)|("date":\d+)/g,r=>{let[n]=r.split(":");return`${n}:1704067200000`})}generateBuildReport(){return{fileCount:this.state.fileHashes.size,contentHash:this.computeOverallHash(),isDeterministic:!0}}};var Sn=class{store=new Map;set(e,r,n){this.store.set(e,r),n&&setTimeout(()=>this.store.delete(e),n)}get(e){return this.store.get(e)}delete(e){this.store.delete(e)}};var En=class{async connect(){throw new Error("Redis implementation requires external library. Install: npm install redis")}async set(e,r,n){throw new Error("Redis implementation requires external library. Install: npm install redis")}async get(e){throw new Error("Redis implementation requires external library. Install: npm install redis")}async delete(e){throw new Error("Redis implementation requires external library. Install: npm install redis")}};function $n(t){let e=t.headers.cookie;if(!e)return{};let r={};for(let n of e.split(";")){let[i,...o]=n.trim().split("=");r[i]=decodeURIComponent(o.join("=")||"")}return r}function kn(t){let e={};for(let[r,n]of Object.entries(t))Array.isArray(n)?e[r]=n.join(", "):typeof n=="string"&&(e[r]=n);return e}function An(t,e){for(let r of t){let n=new RegExp(r.pattern),i=e.match(n);if(!i)continue;let o={};for(let s=0;s<r.paramNames.length;s++)o[r.paramNames[s]]=decodeURIComponent(i[s+1]??"");return{route:r,params:o}}return null}var $t=class{async connect(e){throw new Error("SQLite implementation requires external library. Install: npm install sqlite3 sqlite")}async query(e,r=[]){throw new Error("SQLite implementation requires external library. Install: npm install sqlite3 sqlite")}};var kt=class{connect(e){throw new Error("PostgreSQL implementation requires external library. Install: npm install pg")}async query(e,r=[]){throw new Error("PostgreSQL implementation requires external library. Install: npm install pg")}};var At=class{connect(e){throw new Error("MySQL implementation requires external library. Install: npm install mysql2")}async query(e,r=[]){throw new Error("MySQL implementation requires external library. Install: npm install mysql2")}};var jt=class{async connect(e,r){throw new Error("MongoDB implementation requires external library. Install: npm install mongodb")}async query(e,r={}){throw new Error("MongoDB implementation requires external library. Install: npm install mongodb")}};var jn=class{config;schema;lua;sqlite=new $t;postgres=new kt;mysql=new At;mongo=new jt;constructor(e,r,n){this.config=e,this.schema=r,this.lua=n}async connect(){switch(this.config.driver){case"sqlite":await this.sqlite.connect(this.config.connectionString);break;case"postgres":this.postgres.connect(this.config.connectionString);break;case"mysql":this.mysql.connect(this.config.connectionString);break;case"mongodb":await this.mongo.connect(this.config.connectionString);break;default:throw new Error("Unsupported driver")}}async query(e,r,n=[]){switch(this.config.driver){case"sqlite":return await this.sqlite.query(r,n);case"postgres":return await this.postgres.query(r,n);case"mysql":return await this.mysql.query(r,n);case"mongodb":return await this.mongo.query(e,r);default:throw new Error("Unsupported driver")}}};var Cn=class{schemas={};register(e,r){this.schemas[e]=r}get(e){let r=this.schemas[e];if(!r)throw new Error(`Schema not found: ${e}`);return r}all(){return this.schemas}};var jl={sqlite:{createUsers:`
      CREATE TABLE IF NOT EXISTS users (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        username TEXT NOT NULL,
        email TEXT
      )
    `},postgres:{createUsers:`
      CREATE TABLE IF NOT EXISTS users (
        id SERIAL PRIMARY KEY,
        username VARCHAR(255) NOT NULL,
        email VARCHAR(255)
      )
    `},mysql:{createUsers:`
      CREATE TABLE IF NOT EXISTS users (
        id INT AUTO_INCREMENT PRIMARY KEY,
        username VARCHAR(255) NOT NULL,
        email VARCHAR(255)
      )
    `}};async function Cl(t="sqlite"){K.info(`Migrating database (${t})...`),K.info("Migration complete.")}async function Dl(){K.info("Seeding database...");let t=[{username:"Alice",email:"alice@example.com"},{username:"Bob",email:"bob@example.com"}];K.info("Seeding complete.")}var Dn=class{hooks=[];register(e){this.hooks.push(e)}run(e,r,n){for(let i of this.hooks)i(e,r,n)}};async function Il(t,e){throw new Error("GraphQL implementation requires external library. Install: npm install graphql")}var Ml=null;var er=[],Nl={users:()=>er,createUser:({name:t,email:e})=>{let r={id:(er.length+1).toString(),name:t,email:e};return er.push(r),r}};var Tn={hello:"Hello",welcome:"Welcome"};var On={hello:"Hola",welcome:"Bienvenido"};var qo={en:Tn,es:On},In=class{locale;constructor(e="en"){this.locale=e}setLocale(e){this.locale=e}t(e){return qo[this.locale][e]||e}};function Pn(t){return async(e,r)=>{let n=-1;async function i(o){if(o<=n)throw new Error("next() called multiple times");n=o;let s=t[o]??r;s&&await s(e,()=>i(o+1))}await i(0)}}import{createServer as zo}from"node:http";async function Mn(t={}){let e=t.port||5173,r=t.hostname||"0.0.0.0",n=t.root||process.cwd(),i=zo((o,s)=>{s.writeHead(200,{"content-type":"text/plain"}),s.end(`TypeScript dev server stub (replace with Rust native build in production)
`)});return i.listen(e,r,()=>{console.log(`[DEV SERVER] Listening on http://${r}:${e}`)}),i}import.meta.url===`file://${process.argv[1]}`&&Mn();var Rn=Ct(xt(),1);async function Wo(t){return await Rn.default.build({entryPoints:[t.entryPoint],outdir:t.outdir||"dist",format:t.format||"esm",minify:t.minify??!1,sourcemap:t.sourcemap??!1,platform:"browser",target:"es2022",logLevel:"info"})}async function Jo(t,e){console.log(`[BUNDLER] Packaging assets from ${t} to ${e}`)}async function Go(t){return console.log(`[STYLE COMPILER] Compiling SCSS: ${t.input}`),`
    /* SCSS compiled from: ${t.input} */
    /* Note: Full SCSS compilation requires dart-sass or native Rust implementation */
    body { margin: 0; padding: 0; }
  `}async function Yo(t,e=!1){return console.log(`[STYLE COMPILER] Processing CSS: ${t}`),t}async function Ko(t,e,r){console.log(`[STYLE COMPILER] Watching: ${t}`)}async function Vo(t){console.log(`[OPTIMIZER] Optimizing ${t.files.length} files`);let e=1024*100,r=1024*75;return{originalSize:e,optimizedSize:r,savings:e-r,files:t.files}}async function Zo(t,e,r={}){console.log(`[OPTIMIZER] Image optimization: ${t} -> ${e}`)}async function Qo(t){return t.replace(/\s+/g," ").replace(/>\s+</g,"><").trim()}var Vl={devServer:{name:"dev-server",status:"stub",implementation:"TypeScript"},bundler:{name:"bundler",status:"stub",implementation:"esbuild wrapper"},styleCompiler:{name:"style-compiler",status:"stub",implementation:"TypeScript"},optimizer:{name:"optimizer",status:"stub",implementation:"TypeScript"}};console.log("[NATIVE MODULES] Loaded (TypeScript stubs - replace with native bindings in production)");import{readdirSync as Xo}from"node:fs";import{join as es}from"node:path";import{pathToFileURL as ts}from"node:url";var tr="src/plugin/plugins";async function sc(t="build"){K.info(`Running plugins (${t})...`);try{let e=Xo(tr);for(let r of e){if(!r.endsWith(".ts")&&!r.endsWith(".js"))continue;let n=es(process.cwd(),tr,r),i=ts(n).href;try{let s=(await import(i)).default;if(!s)continue;K.info(`  Loading plugin: ${s.name}`),t==="build"&&s.onBuild?await s.onBuild():t==="serve"&&s.onServe?await s.onServe():t==="deploy"&&s.onDeploy&&await s.onDeploy()}catch(o){K.error(`  Plugin error: ${r} - ${String(o)}`)}}K.info("Plugins executed.")}catch{K.warn(`Plugin directory not found: ${tr}`)}}function Nn(){let t=document.getElementById("__FRAMEWORK_DATA__");if(!t)return null;try{return JSON.parse(t.textContent||"null")}catch{return null}}async function fc(t){let e=Nn(),n=(await import(t)).default,i=ae(n,{data:e?.data??null,params:e?.params??{},query:e?.query??{}}),o=document.getElementById("app");o&&Lt(i,o)}import{join as Gn}from"node:path";import*as Fe from"node:fs";import{join as ss,normalize as as,resolve as ls,sep as cs}from"node:path";import{join as rr,resolve as rs}from"path";import{readdirSync as ns,statSync as is}from"fs";function nr(t,e,r=""){t=rs(".",t);let n=ns(t),i=0,o,s;for(;i<n.length;i++)o=rr(t,n[i]),s=is(o),s.isDirectory()?nr(o,e,rr(r,n[i])):e(rr(r,n[i]),o,s)}import*as Ln from"node:querystring";function Fn(t){let e=t.url;if(e==null)return;let r=t._parsedUrl;if(r&&r.raw===e)return r;let n=e,i="",o,s;if(e.length>1){let c=e.indexOf("#",1);c!==-1&&(s=e.substring(c),n=e.substring(0,c)),c=n.indexOf("?",1),c!==-1&&(i=n.substring(c),n=n.substring(0,c),i.length>1&&(o=Ln.parse(i.substring(1))))}return t._parsedUrl={pathname:n,search:i,query:o,hash:s,raw:e}}var os={"3g2":"video/3gpp2","3gp":"video/3gpp","3gpp":"video/3gpp","3mf":"model/3mf",aac:"audio/aac",ac:"application/pkix-attr-cert",adp:"audio/adpcm",adts:"audio/aac",ai:"application/postscript",aml:"application/automationml-aml+xml",amlx:"application/automationml-amlx+zip",amr:"audio/amr",apng:"image/apng",appcache:"text/cache-manifest",appinstaller:"application/appinstaller",appx:"application/appx",appxbundle:"application/appxbundle",asc:"application/pgp-keys",atom:"application/atom+xml",atomcat:"application/atomcat+xml",atomdeleted:"application/atomdeleted+xml",atomsvc:"application/atomsvc+xml",au:"audio/basic",avci:"image/avci",avcs:"image/avcs",avif:"image/avif",aw:"application/applixware",bdoc:"application/bdoc",bin:"application/octet-stream",bmp:"image/bmp",bpk:"application/octet-stream",btf:"image/prs.btif",btif:"image/prs.btif",buffer:"application/octet-stream",ccxml:"application/ccxml+xml",cdfx:"application/cdfx+xml",cdmia:"application/cdmi-capability",cdmic:"application/cdmi-container",cdmid:"application/cdmi-domain",cdmio:"application/cdmi-object",cdmiq:"application/cdmi-queue",cer:"application/pkix-cert",cgm:"image/cgm",cjs:"application/node",class:"application/java-vm",coffee:"text/coffeescript",conf:"text/plain",cpl:"application/cpl+xml",cpt:"application/mac-compactpro",crl:"application/pkix-crl",css:"text/css",csv:"text/csv",cu:"application/cu-seeme",cwl:"application/cwl",cww:"application/prs.cww",davmount:"application/davmount+xml",dbk:"application/docbook+xml",deb:"application/octet-stream",def:"text/plain",deploy:"application/octet-stream",dib:"image/bmp","disposition-notification":"message/disposition-notification",dist:"application/octet-stream",distz:"application/octet-stream",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",dot:"application/msword",dpx:"image/dpx",drle:"image/dicom-rle",dsc:"text/prs.lines.tag",dssc:"application/dssc+der",dtd:"application/xml-dtd",dump:"application/octet-stream",dwd:"application/atsc-dwd+xml",ear:"application/java-archive",ecma:"application/ecmascript",elc:"application/octet-stream",emf:"image/emf",eml:"message/rfc822",emma:"application/emma+xml",emotionml:"application/emotionml+xml",eps:"application/postscript",epub:"application/epub+zip",exe:"application/octet-stream",exi:"application/exi",exp:"application/express",exr:"image/aces",ez:"application/andrew-inset",fdf:"application/fdf",fdt:"application/fdt+xml",fits:"image/fits",g3:"image/g3fax",gbr:"application/rpki-ghostbusters",geojson:"application/geo+json",gif:"image/gif",glb:"model/gltf-binary",gltf:"model/gltf+json",gml:"application/gml+xml",gpx:"application/gpx+xml",gram:"application/srgs",grxml:"application/srgs+xml",gxf:"application/gxf",gz:"application/gzip",h261:"video/h261",h263:"video/h263",h264:"video/h264",heic:"image/heic",heics:"image/heic-sequence",heif:"image/heif",heifs:"image/heif-sequence",hej2:"image/hej2k",held:"application/atsc-held+xml",hjson:"application/hjson",hlp:"application/winhlp",hqx:"application/mac-binhex40",hsj2:"image/hsj2",htm:"text/html",html:"text/html",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",img:"application/octet-stream",in:"text/plain",ini:"text/plain",ink:"application/inkml+xml",inkml:"application/inkml+xml",ipfix:"application/ipfix",iso:"application/octet-stream",its:"application/its+xml",jade:"text/jade",jar:"application/java-archive",jhc:"image/jphc",jls:"image/jls",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpf:"image/jpx",jpg:"image/jpeg",jpg2:"image/jp2",jpgm:"image/jpm",jpgv:"video/jpeg",jph:"image/jph",jpm:"image/jpm",jpx:"image/jpx",js:"text/javascript",json:"application/json",json5:"application/json5",jsonld:"application/ld+json",jsonml:"application/jsonml+json",jsx:"text/jsx",jt:"model/jt",jxl:"image/jxl",jxr:"image/jxr",jxra:"image/jxra",jxrs:"image/jxrs",jxs:"image/jxs",jxsc:"image/jxsc",jxsi:"image/jxsi",jxss:"image/jxss",kar:"audio/midi",ktx:"image/ktx",ktx2:"image/ktx2",less:"text/less",lgr:"application/lgr+xml",list:"text/plain",litcoffee:"text/coffeescript",log:"text/plain",lostxml:"application/lost+xml",lrf:"application/octet-stream",m1v:"video/mpeg",m21:"application/mp21",m2a:"audio/mpeg",m2t:"video/mp2t",m2ts:"video/mp2t",m2v:"video/mpeg",m3a:"audio/mpeg",m4a:"audio/mp4",m4p:"application/mp4",m4s:"video/iso.segment",ma:"application/mathematica",mads:"application/mads+xml",maei:"application/mmt-aei+xml",man:"text/troff",manifest:"text/cache-manifest",map:"application/json",mar:"application/octet-stream",markdown:"text/markdown",mathml:"application/mathml+xml",mb:"application/mathematica",mbox:"application/mbox",md:"text/markdown",mdx:"text/mdx",me:"text/troff",mesh:"model/mesh",meta4:"application/metalink4+xml",metalink:"application/metalink+xml",mets:"application/mets+xml",mft:"application/rpki-manifest",mid:"audio/midi",midi:"audio/midi",mime:"message/rfc822",mj2:"video/mj2",mjp2:"video/mj2",mjs:"text/javascript",mml:"text/mathml",mods:"application/mods+xml",mov:"video/quicktime",mp2:"audio/mpeg",mp21:"application/mp21",mp2a:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mp4a:"audio/mp4",mp4s:"application/mp4",mp4v:"video/mp4",mpd:"application/dash+xml",mpe:"video/mpeg",mpeg:"video/mpeg",mpf:"application/media-policy-dataset+xml",mpg:"video/mpeg",mpg4:"video/mp4",mpga:"audio/mpeg",mpp:"application/dash-patch+xml",mrc:"application/marc",mrcx:"application/marcxml+xml",ms:"text/troff",mscml:"application/mediaservercontrol+xml",msh:"model/mesh",msi:"application/octet-stream",msix:"application/msix",msixbundle:"application/msixbundle",msm:"application/octet-stream",msp:"application/octet-stream",mtl:"model/mtl",mts:"video/mp2t",musd:"application/mmt-usd+xml",mxf:"application/mxf",mxmf:"audio/mobile-xmf",mxml:"application/xv+xml",n3:"text/n3",nb:"application/mathematica",nq:"application/n-quads",nt:"application/n-triples",obj:"model/obj",oda:"application/oda",oga:"audio/ogg",ogg:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",omdoc:"application/omdoc+xml",onepkg:"application/onenote",onetmp:"application/onenote",onetoc:"application/onenote",onetoc2:"application/onenote",opf:"application/oebps-package+xml",opus:"audio/ogg",otf:"font/otf",owl:"application/rdf+xml",oxps:"application/oxps",p10:"application/pkcs10",p7c:"application/pkcs7-mime",p7m:"application/pkcs7-mime",p7s:"application/pkcs7-signature",p8:"application/pkcs8",pdf:"application/pdf",pfr:"application/font-tdpfr",pgp:"application/pgp-encrypted",pkg:"application/octet-stream",pki:"application/pkixcmp",pkipath:"application/pkix-pkipath",pls:"application/pls+xml",png:"image/png",prc:"model/prc",prf:"application/pics-rules",provx:"application/provenance+xml",ps:"application/postscript",pskcxml:"application/pskc+xml",pti:"image/prs.pti",qt:"video/quicktime",raml:"application/raml+yaml",rapd:"application/route-apd+xml",rdf:"application/rdf+xml",relo:"application/p2p-overlay+xml",rif:"application/reginfo+xml",rl:"application/resource-lists+xml",rld:"application/resource-lists-diff+xml",rmi:"audio/midi",rnc:"application/relax-ng-compact-syntax",rng:"application/xml",roa:"application/rpki-roa",roff:"text/troff",rq:"application/sparql-query",rs:"application/rls-services+xml",rsat:"application/atsc-rsat+xml",rsd:"application/rsd+xml",rsheet:"application/urc-ressheet+xml",rss:"application/rss+xml",rtf:"text/rtf",rtx:"text/richtext",rusd:"application/route-usd+xml",s3m:"audio/s3m",sbml:"application/sbml+xml",scq:"application/scvp-cv-request",scs:"application/scvp-cv-response",sdp:"application/sdp",senmlx:"application/senml+xml",sensmlx:"application/sensml+xml",ser:"application/java-serialized-object",setpay:"application/set-payment-initiation",setreg:"application/set-registration-initiation",sgi:"image/sgi",sgm:"text/sgml",sgml:"text/sgml",shex:"text/shex",shf:"application/shf+xml",shtml:"text/html",sieve:"application/sieve",sig:"application/pgp-signature",sil:"audio/silk",silo:"model/mesh",siv:"application/sieve",slim:"text/slim",slm:"text/slim",sls:"application/route-s-tsid+xml",smi:"application/smil+xml",smil:"application/smil+xml",snd:"audio/basic",so:"application/octet-stream",spdx:"text/spdx",spp:"application/scvp-vp-response",spq:"application/scvp-vp-request",spx:"audio/ogg",sql:"application/sql",sru:"application/sru+xml",srx:"application/sparql-results+xml",ssdl:"application/ssdl+xml",ssml:"application/ssml+xml",stk:"application/hyperstudio",stl:"model/stl",stpx:"model/step+xml",stpxz:"model/step-xml+zip",stpz:"model/step+zip",styl:"text/stylus",stylus:"text/stylus",svg:"image/svg+xml",svgz:"image/svg+xml",swidtag:"application/swid+xml",t:"text/troff",t38:"image/t38",td:"application/urc-targetdesc+xml",tei:"application/tei+xml",teicorpus:"application/tei+xml",text:"text/plain",tfi:"application/thraud+xml",tfx:"image/tiff-fx",tif:"image/tiff",tiff:"image/tiff",toml:"application/toml",tr:"text/troff",trig:"application/trig",ts:"video/mp2t",tsd:"application/timestamped-data",tsv:"text/tab-separated-values",ttc:"font/collection",ttf:"font/ttf",ttl:"text/turtle",ttml:"application/ttml+xml",txt:"text/plain",u3d:"model/u3d",u8dsn:"message/global-delivery-status",u8hdr:"message/global-headers",u8mdn:"message/global-disposition-notification",u8msg:"message/global",ubj:"application/ubjson",uri:"text/uri-list",uris:"text/uri-list",urls:"text/uri-list",vcard:"text/vcard",vrml:"model/vrml",vtt:"text/vtt",vxml:"application/voicexml+xml",war:"application/java-archive",wasm:"application/wasm",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webmanifest:"application/manifest+json",webp:"image/webp",wgsl:"text/wgsl",wgt:"application/widget",wif:"application/watcherinfo+xml",wmf:"image/wmf",woff:"font/woff",woff2:"font/woff2",wrl:"model/vrml",wsdl:"application/wsdl+xml",wspolicy:"application/wspolicy+xml",x3d:"model/x3d+xml",x3db:"model/x3d+fastinfoset",x3dbz:"model/x3d+binary",x3dv:"model/x3d-vrml",x3dvz:"model/x3d+vrml",x3dz:"model/x3d+xml",xaml:"application/xaml+xml",xav:"application/xcap-att+xml",xca:"application/xcap-caps+xml",xcs:"application/calendar+xml",xdf:"application/xcap-diff+xml",xdssc:"application/dssc+xml",xel:"application/xcap-el+xml",xenc:"application/xenc+xml",xer:"application/patch-ops-error+xml",xfdf:"application/xfdf",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xhvml:"application/xv+xml",xlf:"application/xliff+xml",xm:"audio/xm",xml:"text/xml",xns:"application/xcap-ns+xml",xop:"application/xop+xml",xpl:"application/xproc+xml",xsd:"application/xml",xsf:"application/prs.xsf+xml",xsl:"application/xml",xslt:"application/xml",xspf:"application/xspf+xml",xvm:"application/xv+xml",xvml:"application/xv+xml",yaml:"text/yaml",yang:"application/yang",yin:"application/yin+xml",yml:"text/yaml",zip:"application/zip"};function Hn(t){let e=(""+t).trim().toLowerCase(),r=e.lastIndexOf(".");return os[~r?e.substring(++r):e]}var ps=()=>{};function us(t,e){for(let r=0;r<e.length;r++)if(e[r].test(t))return!0}function Un(t,e){let r=0,n,i=t.length-1;t.charCodeAt(i)===47&&(t=t.substring(0,i));let o=[],s=`${t}/index`;for(;r<e.length;r++)n=e[r]?`.${e[r]}`:"",t&&o.push(t+n),o.push(s+n);return o}function fs(t,e,r){let n=0,i,o=Un(e,r);for(;n<o.length;n++)if(i=t[o[n]])return i}function ds(t,e,r,n){let i=0,o=Un(r,n),s,c,a,p;for(;i<o.length;i++)if(s=as(ss(t,a=o[i])),s.startsWith(t)&&Fe.existsSync(s)){if(c=Fe.statSync(s),c.isDirectory())continue;return p=Bn(a,c,e),p["Cache-Control"]=e?"no-cache":"no-store",{abs:s,stats:c,headers:p}}}function ms(t,e){return e.statusCode=404,e.end()}function hs(t,e,r,n,i){let o=200,s,c={};i={...i};for(let a in i)s=e.getHeader(a),s&&(i[a]=s);if((s=e.getHeader("content-type"))&&(i["Content-Type"]=s),t.headers.range){o=206;let[a,p]=t.headers.range.replace("bytes=","").split("-"),u=c.end=parseInt(p,10)||n.size-1,l=c.start=parseInt(a,10)||0;if(u>=n.size&&(u=n.size-1),l>=n.size)return e.setHeader("Content-Range",`bytes */${n.size}`),e.statusCode=416,e.end();i["Content-Range"]=`bytes ${l}-${u}/${n.size}`,i["Content-Length"]=u-l+1,i["Accept-Ranges"]="bytes"}e.writeHead(o,i),Fe.createReadStream(r,c).pipe(e)}var gs={".br":"br",".gz":"gzip"};function Bn(t,e,r){let n=gs[t.slice(-3)],i=Hn(t.slice(0,n&&-3))||"";i==="text/html"&&(i+=";charset=utf-8");let o={"Content-Length":e.size,"Content-Type":i,"Last-Modified":e.mtime.toUTCString()};return n&&(o["Content-Encoding"]=n),r&&(o.ETag=`W/"${e.size}-${e.mtime.getTime()}"`),o}function ir(t,e={}){t=ls(t||".");let r=e.onNoMatch||ms,n=e.setHeaders||ps,i=e.extensions||["html","htm"],o=e.gzip&&i.map(g=>`${g}.gz`).concat("gz"),s=e.brotli&&i.map(g=>`${g}.br`).concat("br"),c={},a="/",p=!!e.etag,u=!!e.single;if(typeof e.single=="string"){let g=e.single.lastIndexOf(".");a+=~g?e.single.substring(0,g):e.single}let l=[];e.ignores!==!1&&(l.push(/[/]([A-Za-z\s\d~$._-]+\.\w+){1,}$/),e.dotfiles?l.push(/\/\.\w/):l.push(/\/\.well-known/),[].concat(e.ignores||[]).forEach(g=>{l.push(new RegExp(g,"i"))}));let E=e.maxAge!=null&&`public,max-age=${e.maxAge}`;E&&e.immutable?E+=",immutable":E&&e.maxAge===0&&(E+=",must-revalidate"),e.dev||nr(t,(g,$,_)=>{if(!/\.well-known[\\+\/]/.test(g)){if(!e.dotfiles&&/(^\.|[\\+|\/+]\.)/.test(g))return}let y=Bn(g,_,p);E&&(y["Cache-Control"]=E),c["/"+g.normalize().replace(/\\+/g,"/")]={abs:$,stats:_,headers:y}});let m=e.dev?ds.bind(0,t+cs,p):fs.bind(0,c);return function(g,$,_){let y=[""],x=Fn(g).pathname,S=g.headers["accept-encoding"]||"";if(o&&S.includes("gzip")&&y.unshift(...o),s&&/(br|brotli)/i.test(S)&&y.unshift(...s),y.push(...i),x.indexOf("%")!==-1)try{x=decodeURI(x)}catch{}let w=m(x,y)||u&&!us(x,l)&&m(a,y);if(!w)return _?_():r(g,$);if(p&&g.headers["if-none-match"]===w.headers.ETag)return $.writeHead(304),$.end();(o||s)&&$.setHeader("Vary","Accept-Encoding"),n($,x,w.stats),hs(g,$,w.abs,w.stats,w.headers)}}import{existsSync as ys}from"node:fs";import{join as xs}from"node:path";async function qn(t){let{req:e,res:r,siteDir:n}=t,i=new URL(e.url??"/",`http://${e.headers.host??"localhost"}`);if(!i.pathname.startsWith("/api/"))return!1;let o=i.pathname.slice(5)||"home",s=xs(process.cwd(),n,"api",`(${o}).ts`);if(!ys(s))return r.statusCode=404,r.setHeader("content-type","application/json; charset=utf-8"),r.end(JSON.stringify({error:"API route not found",route:o})),!0;let a=(await import(s))?.default;if(typeof a!="function")return r.statusCode=500,r.setHeader("content-type","application/json; charset=utf-8"),r.end(JSON.stringify({error:"API route missing default export function"})),!0;let p=await ws(e),u={req:e,res:r,url:i,method:e.method??"GET",query:Object.fromEntries(i.searchParams.entries()),body:p},l=await a(u);if(r.writableEnded)return!0;if(l instanceof Response){r.statusCode=l.status,l.headers.forEach((m,g)=>r.setHeader(g,m));let E=Buffer.from(await l.arrayBuffer());return r.end(E),!0}return typeof l=="string"?(r.statusCode=200,r.setHeader("content-type","text/plain; charset=utf-8"),r.end(l),!0):(r.statusCode=200,r.setHeader("content-type","application/json; charset=utf-8"),r.end(JSON.stringify(l??null)),!0)}async function ws(t){let e=(t.method??"GET").toUpperCase();if(e==="GET"||e==="HEAD")return null;let r=[];for await(let o of t)r.push(Buffer.from(o));if(r.length===0)return null;let n=Buffer.concat(r).toString("utf8"),i=t.headers["content-type"]??"";if(typeof i=="string"&&i.includes("application/json"))try{return JSON.parse(n)}catch{return{__raw:n}}return{__raw:n}}var zn=Ct(xt(),1);import{readFileSync as bs}from"node:fs";import{createHash as vs}from"node:crypto";import{existsSync as _s}from"node:fs";var or=new Map;function Ss(t){return vs("sha1").update(t).digest("hex")}function Wn(){return`
import { hydrate } from "https://esm.sh/preact@10.25.4";
import { h } from "https://esm.sh/preact@10.25.4";

function getFrameworkData() {
  const el = document.getElementById("__FRAMEWORK_DATA__");
  if (!el) return null;
  try { return JSON.parse(el.textContent || "null"); } catch { return null; }
}

export async function hydrateClient(entryPath) {
  const data = getFrameworkData();
  const mod = await import(entryPath);
  const Page = mod.default;
  const app = h(Page, {
    data: data?.data ?? null,
    params: data?.params ?? {},
    query: data?.query ?? {}
  });
  const root = document.getElementById("app");
  if (!root) return;
  hydrate(app, root);
}
`}function Jn(t){let e=t;if(!_s(e))return"export default function Page(){ return null }";let r=e,n=or.get(r),i=bs(e,"utf8"),s=`
import { h } from "https://esm.sh/preact@10.25.4";
import { Fragment } from "https://esm.sh/preact@10.25.4";
import { jsx, jsxs } from "https://esm.sh/preact@10.25.4/jsx-runtime";
`+(0,zn.buildSync)({stdin:{contents:i,resolveDir:e.split(/[\/\\]/).slice(0,-1).join("/"),sourcefile:e,loader:e.endsWith(".tsx")?"tsx":e.endsWith(".jsx")?"jsx":e.endsWith(".ts")?"ts":"js"},format:"esm",platform:"browser",bundle:!0,write:!1,sourcemap:"inline",jsx:"automatic",jsxImportSource:"preact",define:{"process.env.NODE_ENV":JSON.stringify("development")},external:["preact","preact/hooks","preact/jsx-runtime","preact-render-to-string"]}).outputFiles?.[0]?.text,c=Ss(s);return or.set(r,{js:s,etag:c}),s}function Dc(t){return or.get(t)?.etag??null}async function Bc(t){let{config:e,mode:r}=t,n=Ve(e);K.info(`Routes discovered: ${n.length}`);for(let a of n)K.info(`  ${a.urlPath} -> ${a.filePath}`);let i=ir(Gn(process.cwd(),e.siteDir),{dev:r==="dev",etag:!0}),o=ir(Gn(process.cwd(),e.distDir),{dev:r==="dev",etag:!0}),c=Pn([async(a,p)=>{K.info(`${a.req.method} ${a.url.pathname}`),await p()},async(a,p)=>{if(a.url.pathname==="/__runtime/hydrate.js"){a.res.statusCode=200,a.res.setHeader("content-type","application/javascript; charset=utf-8"),a.res.end(Wn());return}if(a.url.pathname==="/__hydrate"){let u=a.url.searchParams.get("file");if(!u){a.res.statusCode=400,a.res.end("missing file");return}let l=Jn(u);a.res.statusCode=200,a.res.setHeader("content-type","application/javascript; charset=utf-8"),a.res.setHeader("cache-control","no-store"),a.res.end(l);return}await p()},async(a,p)=>{await qn({req:a.req,res:a.res,siteDir:e.siteDir})||await p()},async(a,p)=>{r==="prod"&&(await new Promise(u=>{o(a.req,a.res,()=>u())}),a.res.writableEnded||a.res.headersSent)||await p()},async(a,p)=>{r==="dev"&&(await new Promise(u=>{i(a.req,a.res,()=>u())}),a.res.writableEnded||a.res.headersSent)||await p()},async(a,p)=>{if(a.req.method!=="GET")return p();let u=An(n,a.url.pathname);if(!u)return p();let l=kn(a.req.headers),E=$n(a.req),m={};for(let[$,_]of a.url.searchParams.entries())m[$]=_;let g=await wt({config:e,route:u.route,url:a.url,params:u.params,query:m,headers:l,cookies:E});a.res.statusCode=200,a.res.setHeader("content-type","text/html; charset=utf-8"),a.res.end(g)},async a=>{a.res.statusCode=404,a.res.setHeader("content-type","text/plain; charset=utf-8"),a.res.end("404 Not Found")}]);return{async handle(a,p){let u=new URL(a.url??"/",`http://${a.headers.host??"localhost"}`);await c({req:a,res:p,url:u},async()=>{})}}}export{Ea as ASSET_HASH_INVARIANTS,Xa as ASSET_MAP_SCRIPT,Et as AssetHasher,_t as AssetManifest,we as BuildInvariants,wn as CorrectedSSGPipeline,jn as DB,Fo as DEFER_CSS_TEMPLATE,_n as DeterministicBuilder,Qa as FRAMEWORK_DATA_SCRIPT,ka as HYDRATION_INVARIANTS,In as I18n,ja as INVARIANTS,bn as ISLAND_RUNTIME_MINIFIED,Dn as LuaHooks,Sn as MemoryCache,je as Minifier,jt as MongoDriver,At as MySQLDriver,Vl as NATIVE_MODULES,Za as PRELOAD_TEMPLATE,kt as PostgresDriver,En as RedisCache,$t as SQLiteDriver,vt as SSGBuilder,gn as SSGPipeline,Cn as SchemaManager,ar as SessionManager,yn as buildCriticalCss,Ya as buildDocumentHtml,Jn as buildHydrationModule,na as buildSite,Wo as bundle,Jo as bundleAssets,Yo as compileCSS,Go as compileScss,Pn as compose,Ia as compressJson,Bc as createApp,Lo as createCriticalCssExtractor,Xt as createIslandRegistry,Mo as extractIslandsFromHtml,Sa as generateCacheHeaders,Ho as generateHydrationInjection,Po as generateIslandHydrationScript,el as generateRuntimeConfig,Nn as getFrameworkData,Dc as getHydrationEtag,kn as headersToObject,fc as hydrateClient,il as injectAnalyticsPixel,tl as injectCriticalCss,rl as injectDeferredCss,No as injectFrameworkData,nl as injectHydrationScript,Ro as injectIslandScript,K as log,Io as markIsland,An as matchRoute,Cl as migrateDb,jl as migrations,Qo as minifyHTML,Vo as optimize,Zo as optimizeImages,$n as parseCookies,Oa as removeWhitespace,Ga as renderPage,wt as renderRouteToHtml,ur as resolveDistPath,Ls as resolveSitePath,Nl as resolvers,sc as runPlugins,Il as runQuery,Wn as runtimeHydrateModule,Ka as sanitizeHtml,Ve as scanRoutes,Ml as schema,Dl as seedDb,As as signToken,Mn as startDevServer,Da as stripCommentsFromCss,Ta as stripCommentsFromJs,qn as tryHandleApiRoute,_a as updateHtmlReferences,js as verifyToken,Ko as watchStyles};
